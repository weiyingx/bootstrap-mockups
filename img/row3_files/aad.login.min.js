function pageOnReady(){if($(".no_display").each(function(e,t){t.setAttribute("aria-hidden","true")}),$(".hidden").each(function(e,t){t.setAttribute("aria-hidden","true")}),$(".login_inner_container.no_display").removeClass("no_display"),$("#background_background_image").css("width","auto"),$("#background_background_image").css("height","auto"),User.RegisterOnLoadImage(),$.browser.msie&&"8"==$.browser.version.slice(0,1)?document.body.onresize=function(){User.resize_bg()}:$(window).resize(function(){User.resize_bg()}),void 0!=$("#cred_userid_inputtext").val()&&User.setupCredFieldsWithPlaceHolder(),Context.whr=decodeURIComponent(Util.ExtractQSParam("whr")),User.updateGuestLink(),$("#redirect_cancel_link").on("click",function(e){e.preventDefault(),Context.back_action_stack.TriggerCancelAction()}),$("#login_panel").show(),$("#login_no_script_panel").hide(),$(".login_cred_container").append($("<input/>").attr("id","home_realm_discovery").attr("type","hidden").val(Context.username_state.home_realm_state)),Constants.IS_HOLOGRAPHIC)$("div.progress").css("visibility","hidden");else{var e=$("#cred_sign_in_button"),t=$("#cred_cancel_button");e.click(function(){Post.SubmitCreds()}),e.keydown(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$(".refresh_domain_state").click(function(){User.RefreshDomainState()}),$("input[type=checkbox]").click(function(){User.RefreshDomainState()}),t.click(function(){Context.back_action_stack.DoesCancelActionExist()?Context.back_action_stack.TriggerCancelAction():Constants.IS_CXH_REQUEST?Util.CancelCxhFlow():Constants.IS_ADAL_REQUEST&&User.GetRedirectWithOAuthResponseMode(Constants.responseMode,Constants.CANCEL_REDIRECT_URL,Constants.cancelErrorParams)()})}$("#background_company_name_text").text(Constants.PARTNER_NAME),Constants.FEDERATION_QUERY_PARAMETERS=Constants.FEDERATION_QUERY_PARAMETERS.replace(/&username(=[^&]*)?|^username(=[^&]*)?&?/,""),Support.renderBrowserSpecific(),Support.UpdatePasswordResetLink(),Constants.isChinaDC||($("#footer_link_terms").click(function(e){e.preventDefault(),MSLogin.Support.LegalActionLink("/termsofuse?mkt="+Constants.Locale)}),$("#footer_link_privacy").click(function(e){e.preventDefault(),MSLogin.Support.LegalActionLink("/privacy?mkt="+Constants.Locale)})),$("#footer_link_privacy_windows").click(function(){var e=$("#footer_link_privacy_windows")[0],t=$("#flyoutPrivacyStatement")[0],n=$(".body-container")[0].getBoundingClientRect().top+(window.pageYOffset||document.documentElement.scrollTop||0);t&&(t.style.marginTop=n+"px",t.winControl.show(e,"top","left"))});var n=User.GetRedirectAction(Constants.msaSignupUrl,Constants.msaSignupUrl,Constants.msaRedirSignupErrorParams);if($("#idp-signup-link, #create_msa_account_link").click(function(e){e.preventDefault(),n()}),Constants.IS_ADAL_REQUEST?$("#account_not_found_title_text p").toggleClass("no_display"):$("#create_msa_account_link, #account_not_found_title_text > p > a").click(function(e){e.preventDefault();var t=e.target.getAttribute("href");window.open(t,"_blank"),window.focus()}),Constants.isDesktopSsoEnabled){var o={iwaEndpointUrlFormat:Constants.windowsAuthenticationEndpointUrlFormat,iwaRequestTimeoutInMs:Constants.windowsAuthenticationRequestTimeoutInMs,lastUserNameTried:Constants.desktopSsoLastUserNameTried};proxy.DesktopSso.Initialize(o)}Instrument.document_ready_end_time=Util.now()}!function(){var e=window,t=e.$Debug=e.$Debug||{},n=e.$Config||{};t.options={tracePagePath:!1},t.fail=function(t){var n=new Error(t+" "),o=e.$WebWatson;throw o&&o.submitFromException(n,void 0,33),n},t.assert=function(o,i){o||(i="Assert failed: "+i,n.uxDebug&&e.confirm(i+"\r\n\r\nBreak into debugger?")&&t.fail(i))},t.failIf=function(e,n){e||t.fail(n)},t.trace=function(n,o){if(n||(n=""),console&&console.log){if(t.options.tracePagePath){var i=e.location.pathname;o=o?i+": "+o:i}o&&(n=o+": "+n),console.log(n)}}}(),function(){var e=window,t=e.$Debug,n=e.Array.prototype;n.addRange||(n.addRange=function(e){return e&&this.push.apply(this,e),this}),n.exists||(n.exists=function(e){return this.indexOf(e)>=0}),n.contains||(n.contains=n.exists),n.clone||(n.clone=function(){return[].addRange(this)}),n.indexOf||(n.indexOf=function(e,t){var n=this.length;for((t=t||0)<0&&(t=Math.max(0,n+t));n>t;)if(this[t++]===e)return t-1;return-1}),n.forEach||(n.forEach=function(e,n){t&&t.assert(e,"fnCb must be provided");for(var o=this.length,i=0;o>i;i++)e.call(n,this[i],i,this);t&&t.assert(o==this.length,"Do not modify array during forEach")}),n.insert||(n.insert=function(e,t){this.splice(e,0,t)}),n.remove||(n.remove=function(e){var t=this.indexOf(e);return t>=0&&this.splice(t,1),t>=0})}(),function(){function e(e,t,o){var i=o.s===t;if(!i){t=t||0;var a,r,s=e.charCodeAt(t);o.s=-1,55296>s||s>57343?o.c=s:56319>=s?(a=s,r=e.charCodeAt(t+1),n&&n.assert(!isNaN(r),"High surrogate not followed by low surrogate in fixedCharCodeAt()"),o.c=1024*(a-55296)+(r-56320)+65536,o.s=t+1):(o.c=-1,i=!0)}return!i}var t=window,n=t.$Debug,o=t.String.prototype;o.endsWith=function(e){return n&&n.assert(e,"must provide suffix"),this.substr(this.length-e.length)==e},o.startsWith=function(e){return n&&n.assert(e,"must provide prefix"),this.substr(0,e.length)==e},o.lTrim=function(){return this.replace(/^\s*/,"")},o.rTrim=function(){return this.replace(/\s*$/,"")},o.trim=function(){return this.replace(/^\s+|\s+$/g,"")};var i=/\{\d+\}/g,a=/[\{\}]/g;o.format=function(){function e(e){var o=t[e.replace(a,"")];return n&&n.assert("undefined"!=typeof o,"String Format- Provide argument at index "+e.replace(a,"")),null===o&&(o=""),o}var t=arguments;return this.replace(i,e)};var r=/[^\w.,-]/g;o.encodeXmlAttribute=o.encodeHtmlAttribute=function(){return this.replace(r,function(e){return["&#",e.charCodeAt(0),";"].join("")})};var s=/[^\w .,-]/g;o.encodeXml=o.encodeHtml=function(){var t={c:0,s:-1};return this.replace(s,function(n,o,i){return e(i,o,t)?["&#",t.c,";"].join(""):""})};var d=/[^\w.%-]/g;o.encodeURIComponent=o.encodeUrl=function(){return encodeURIComponent(this).replace(d,function(e){var t=e.charCodeAt(0).toString(16);return"%"+(1==t.length?"0"+t:t).toUpperCase()})};var _=/[^\w .,-]/g;o.encodeJson=function(){return this.replace(_,function(e){var t=e.charCodeAt(0).toString(16),n=new Array(4-t.length+1).join("0");return"\\u"+n+t.toUpperCase()})},o.decodeURIComponent=o.decodeUrl=function(){return decodeURIComponent(this)};var c=/([\\\.\{\}\(\)\[\]\/\+\*\?\|\^\$])/gi;o.escapeRegex=function(e){return(0===arguments.length?this:e).replace(c,"\\$1")},o.areEqualIgnoreCase=function(e){var t=this;return t.toLowerCase()===e.toLowerCase()?!0:!1},o.qs=function(e,t){var n=new RegExp("([?&])"+e+"=([^&#]*)","i");if(t)return this.match(n)?this.replace(n,"$1"+e+"="+t):this.indexOf("?")>0?this+"&"+e+"="+t:this+"?"+e+"="+t;var o=n.exec(this);return null===o?"":o[2]},o.upsertQueryStringParam=function(e,t){return void 0===t?this:this.qs(e,t)},o.removeQueryStringParam=function(e,t){var n=new RegExp("([?&])"+t+"=.*?(&|$)","i");return this.match(n)?this.replace(n,"$1"):this},o.getQueryStringParam=function(e){if(!e)return"";var t=new RegExp("([?&])"+e+"=([^&#]*)","i"),n=this.match(t);return n?n[2]:""},o.getCookie=function(e){for(var n,o,i=this.split(";"),a=0;a<i.length;a++)if(n=i[a].substr(0,i[a].indexOf("=")).replace(/^\s+|\s+$/g,""),o=i[a].substr(i[a].indexOf("=")+1),n===e)return t.unescape(o)},o.htmlEncode=function(){return $("<span/>").text(this).html()},o.htmlDecode=function(){return $("<span/>").html(this).text()}}(),function(){var _object=window.Object;"Object"!=_object.__typeName&&(_object.isString=function(e){return"string"==typeof e||e&&e.constructor===String},_object.isArray=function(e){return e instanceof Array},_object.isFunction=function(e){return"function"==typeof e},_object.isObject=function(e){return e&&"object"==typeof e},_object.isBoolean=function(e){return"boolean"==typeof e||e&&e.constructor===Boolean},_object.isNumber=function(e){return"number"==typeof e||e&&e.constructor===Number},_object.resolve=function(e){try{"string"==typeof e?e=Function.parse(e):"object"==typeof e?e=e.constructor:"function"!=typeof e&&(e=null)}catch(t){return null}return e},_object.compare=function(e,t){var n=this.resolve(e);return n&&n==this.resolve(t)},_object.getType=function(e){var t=e.constructor;return t&&"function"==typeof t&&t.__typeName&&"Object"!=t.__typeName?t:_object},_object.isNull=function(e){return null===e||void 0===e},_object.getTypeName=function(e){return _object.getType(e).__typeName},_object.fromJSON||(_object.fromJSON=function $Object$fromJSON(text){try{if("undefined"!=typeof JSON&&JSON.parse)return JSON.parse(text);if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+text+")")}catch(e){}return null}),_object.toJSON||(_object.toJSON=function(e){if(""===e)return'""';if("undefined"!=typeof JSON&&JSON.stringify)return JSON.stringify(e);var t=_object.toJSON,n="null";if(!_object.isNull(e))if(_object.isArray(e)){n=[];for(var o=0;o<e.length;o++)n.push(t(e[o]));n="["+n.join(",")+"]"}else if(_object.isObject(e)){n=[];for(var i in e)n.push('"'+i.encodeJson()+'":'+t(e[i]));n="{"+n.join(",")+"}"}else _object.isString(e)?n='"'+e.encodeJson()+'"':_object.isFunction(e)||(n=e.toString());return n}),_object.__typeName="Object")}(),function(){function e(e,t,n,o,i){var a={canary:d.apiCanary,hpgid:d.hpgid||0,hpgact:d.hpgact||0,Accept:C};d.correlationId&&(a[h]=d.correlationId);var s=t;return t&&!r(t)&&(s=Object.toJSON(t)),s&&(s=s.replace(/\?/g,"\\u003F")),jQuery.ajax({url:e,dataType:"json",data:s,processData:!1,type:"POST",headers:a,timeout:i||l,success:n,error:o})}function t(e){return e?"<span style='font-weight: bold;'>"+e.toString().encodeHtml()+":</span> ":""}function n(e,n){return n?"<div>"+t(e)+n.toString().encodeHtml()+"</div>":""}function o(e){var t=[];if(e)for(var n=(e||"").split("\n"),o=0;o<n.length;o++)for(var i=n[o],a=(i||"").split("\\r\\n"),r=0;r<a.length;r++){var s=(a[r]||"").replace("\\u000a","").replace("\\u0028","(").replace("\\u0029",")").replace("\\u003a",":").replace("\\u003c","&lt;").replace("\\u003d","=").replace("\\u003e","&gt;").replace("\\u005c","\\");t.push(s)}return t}function i(e){var t="";if(e)for(var n=0;n<e.length;n++)t+=e[n]+"\n";return t}function a(e,t){if(f&&e&&e.error&&(e.error.stackTrace||e.error.debugMessage)){var a=o(e.error.stackTrace),r=null;if(e.error.isFatal||e.error.showError)r=i(a),_&&_.showError(e.error.code,"ApiRequest Error: "+(e.error.message||""),t||"<none>",null,null,null,r,e.error.debugMessage,e.error.data,e.error.isFatal?"#FFC0C0":"#C0FFFF",!0);else if(window.$Debug&&c.scriptConsole){var s=c.scriptConsole;r=i(a),s.errorHtml(n("Url",t)+n("Error Code",e.error.code)+(e.error.message?n("Message",e.error.message):"")+(e.error.isFatal?n("Is Fatal",e.error.isFatal):"")+(e.error.debugMessage?n("Debug",e.error.debugMessage):""),{url:t,code:e.error.code,data:e.error.data,stackTrace:a,rsp:e})}}}function r(e){return"string"===jQuery.type(e)}var s=window,d=s.$Config||{},_=s.$WebWatson,c=s.$Debug||{},l=3e4,u=8e3,g=8001,m=8002,p=100,h="client-request-id",C="application/json",S=s.$Api={},E=S.Errors=[];S.ApiErrorCodes={GeneralError:"6000",AuthFailure:"6001",InvalidArgs:"6002",Generic:u,Timeout:g,Aborted:m};var f=null;S.Json=function(t,n,o,i,r,s){function c(e,t){var n={};if(500==e.status)try{n=Object.fromJSON(e.responseText)||{}}catch(o){}if(!n.error){var i=!1,a=u,r="Request Failed -- No Response from Server";switch(t){case"timeout":a=g,r="Timeout Error",i=!0;break;case"abort":a=m,r="Aborted";break;case"error":e.status>=400&&(i=!0);break;case"parsererror":r="Unable to parse response",i=!0}n.error={code:a,message:r,debugMessage:"(xhr status "+e.status+") xhr.responseText: "+e.responseText,stackTrace:"",isFatal:i}}return n}function l(e){e=e||{};var n,r=e.error||null;if(e.apiCanary&&(d.apiCanary=e.apiCanary,delete e.apiCanary),r){n=r.stackTrace,n=n&&n.encodeJson?n.encodeJson():"";var _='{"code": "'+r.code+'", "message": "'+r.message+'", "debug": "'+r.debugMessage+'", "stacktrace": "'+n+'", "requestUrl": "'+t+'"}';E.push(_),E.length>p&&E.shift(),r.code!=m&&(a(e,t),i&&i(e,s))}else o&&o(e,s)}return null===f&&(f=!1,_&&d.isOneBox&&(f=!0)),e(t,n,function(e){l(e)},function(e,t,n){l(c(e,t,n))},r)}}();var MSLogin={},proxy=proxy||{};MSLogin.ErrorCodes={IDP_ERROR:2147776681,IDP_ERROR2:2147776682,NAMESPACE_ERROR:2147778860,PARSE_ERROR:2147762276};var ErrorCodes=MSLogin.ErrorCodes;MSLogin.Constants={REDIRECT_COUNTDOWN_DEFAULT:3,FEDERATION_QUERY_PARAMETERS:"",CDN_IMAGE_PATH:"images/",LATENCY_THRESHOLD:2e3,PREFETCH_URL:"",LATENCY_SENSITIVITY_DEFAULT:1,OTHER_ACCOUNT_TEXT:"",MAX_TILE_TEXT_LENGTH:25,MEMBER_NAME:"",REDIRECT_MESSAGES:{},METRICS_MODE:1,SUBMIT_METRICS_ON_REDIRECT:!1,SUBMIT_METRICS_ON_POST:!1,INSTRUMENT_PLT:!1,MOBILE_WIDTH_THRESHOLD:600,MOBILE_HEIGHT_THRESHOLD:600,PARTNER_NAME:"",SAVED_USER_COOKIE:"MSSavedUser",PREFILL_USER_COOKIE:"MSPPre",SAVED_USER_COOKIE_INFO_DELIMITER:"$",SAVED_USER_COOKIE_USER_DELIMITER:"|",MAX_USER_TILES:1,DIR:"ltr",TWOFA_POLLING_INTERVAL:null,TWOFA_MAX_POLLS:null,TWOFA_MARKET:null,TWOFA_MAXMETHODS:20,TWOFA_OTP_MAX_LEN:6,TWOFA_TIMEOUT:1e4,TWOFA_ANIMATION_INTERVAL:3e3,TWOFA_AUTH_TIMEOUT:12e4,TWOFA_REMEMBER_DEVICE_ENABLED:!1,SSPR_TIMEOUT:1e4,EMAIL_DISCOVERY_SERVICE_TIMEOUT:3e3,EMAIL_DISCOVERY_SERVICE_URI:"/GetUserRealmExtended.srf",EMAIL_DISCOVERY_DEFAULT_TILES:null,MSA_AUTH_URL:null,TENANT_BRANDING:null,LCID:null,MSA_ACCOUNT_IMG_ALT_TEXT:"",AAD_ACCOUNT_IMG_ALT_TEXT:"",MSA_ACCOUNT_TILE_ALT_TEXT:"",AAD_ACCOUNT_TILE_ALT_TEXT:"",HIP_IMAGE_ALT_TEXT:null,DEFAULT_ILLUSTRATION:"",DEFAULT_ILLUSTRATION_ALT:"",DEFAULT_LOGO:"",DEFAULT_LOGO_ALT:"",DEFAULT_BACKGROUND_COLOR:"#333333",GENERIC_ERROR_CODES:[ErrorCodes.IDP_ERROR,ErrorCodes.IDP_ERROR2,ErrorCodes.NAMESPACE_ERROR,ErrorCodes.PARSE_ERROR],REALM_RESOLVER_URL:"/GetUserRealm.srf",DYNAMIC_BRANDING_CTA_ENABLED:!0,USERNAME_HINT_TEXT:"someone@example.com",REGEX_PHONE:/^[\+]{0,1}([\(\)\- \*\.#/\[\]]*\d[\(\)\- \*\.#/\[\]]*){4,20}$/,REGEX_EMAIL:/^([\w-\.\']+@([\w-]+\.)+[\w-]{2,46})?$/,USER_DOMAIN_HINT_CHANGED_EVENT_NAME:"MSLogin-User-UserDomainHintChanged"},MSLogin.Constants.State={NONE:0,FEDERATED:1,MANAGED:2,INVALID:3,PENDING:4},MSLogin.Constants.MSAccount={EXISTS:0,NOT_EXIST:1,THROTTLED:2},MSLogin.Constants.TokenizedStringMsgs={GENERIC_ERROR:"",UPN_DISAMBIGUATE_MESSAGE:""},MSLogin.Constants.NameSpaceType={UNKNOWN:"Unknown",FEDERATED:"Federated",MANAGED:"Managed"},MSLogin.Constants.FederationProtocol={SAML20:"SAML20"},MSLogin.Constants.EmailDiscoveryAccountState={AAD_UNKNOWN_AND_MSA_NOT_EXIST:0,AAD_UNKNOWN_AND_MSA_EXISTS:1,AAD_UNKNOWN_AND_MSA_THROTTLED:2,AAD_UNKNOWN_AND_MSA_TIMED_OUT:3,AAD_FEDERATED_AND_MSA_NOT_EXIST:4,AAD_FEDERATED_AND_MSA_EXISTS:5,AAD_FEDERATED_AND_MSA_THROTTLED:6,AAD_FEDERATED_AND_MSA_TIMED_OUT:7,AAD_MANAGED_AND_MSA_NOT_EXIST:8,AAD_MANAGED_AND_MSA_EXISTS:9,AAD_MANAGED_AND_MSA_THROTTLED:10,AAD_MANAGED_AND_MSA_TIMED_OUT:11,AAD_TIMED_OUT_AND_MSA_NOT_EXIST:12,AAD_TIMED_OUT_AND_MSA_EXISTS:13,AAD_TIMED_OUT_AND_MSA_THROTTLED:14,AAD_TIMED_OUT_AND_MSA_TIMED_OUT:15,ERROR:16},MSLogin.Constants.CancelAction={FROM_REDIRECT_TO_LOGIN:0,FROM_SHOW_USER_TO_TILES:1,FROM_MANY_TO_EMAILDISCOVERY_INIT:2,FROM_EMAILDISCOVERY_START_TO_TILES:3,FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START:4,FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START:5,FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:6,FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START:7,FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START:8,FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:9,FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES:10,FROM_DISAMBIGUATION_SCREEN_TO_LOGIN:11,FROM_LOGIN_TO_DISAMBIGUATION_SCREEN:12,FROM_REDIRECT_TO_DISAMBIGUATION_SCREEN:13},MSLogin.Constants.AuthNForwardType={NORMAL:0,MULTIAUTH_ADFS:1,NON_MULTIAUTH_ADFS:2,WIAORMULTIAUTHN_ADFS:3},MSLogin.BackActionStack=function(){this.BackActionStack=[]},MSLogin.BackActionStack.prototype.AddAction=function(e){this.BackActionStack.push(e)},MSLogin.BackActionStack.prototype.TriggerCancelAction=function(){Context.post_from_tile=!1;var e=this.BackActionStack.pop();switch(e){case Constants.CancelAction.FROM_REDIRECT_TO_LOGIN:case Constants.CancelAction.FROM_SHOW_USER_TO_TILES:TenantBranding.RestoreDefaultPageBranding(),Tiles.CancelTileRedirect();break;case Constants.CancelAction.FROM_MANY_TO_EMAILDISCOVERY_INIT:EmailDiscovery.Init();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_START_TO_TILES:EmailDiscovery.BackToUserTiles();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.HideAADLoginLayout(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:EmailDiscovery.HideAADLoginLayout(),Context.email_discovery_use_msa_api?this.TriggerCancelAction():EmailDiscovery.ShowSplitter();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.CancelLookingForAccount();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START:Context.username_state.last_checked_email="",EmailDiscovery.CancelRedirect(),EmailDiscovery.ShowEmailDiscovery();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:EmailDiscovery.CancelRedirect(),Context.email_discovery_use_msa_api?this.TriggerCancelAction():EmailDiscovery.ShowSplitter();break;case Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES:EmailDiscovery.HideSplitter(),this.TriggerCancelAction();break;case Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN:Context.username_state.last_checked_email="",Tiles.hideDisambiguationScreen(),Tiles.showUserLoginPage();break;case Constants.CancelAction.FROM_LOGIN_TO_DISAMBIGUATION_SCREEN:MSLogin.SplitterControl.Render();break;case Constants.CancelAction.FROM_REDIRECT_TO_DISAMBIGUATION_SCREEN:User.CancelRedirect(),MSLogin.SplitterControl.Render()}},MSLogin.Store=function(){this.Map={}},MSLogin.Store.prototype.Get=function(e){var t=$.trim(e).toLowerCase();return this.Map[t]},MSLogin.Store.prototype.Add=function(e,t){var n=$.trim(e).toLowerCase();this.Map[n]=t},MSLogin.BackActionStack.prototype.RemoveLastCancelAction=function(){this.BackActionStack.pop()},MSLogin.BackActionStack.prototype.DoesCancelActionExist=function(){return this.BackActionStack.length>0},MSLogin.BackActionStack.prototype.ClearCancelActions=function(){this.BackActionStack=[]};var Constants=MSLogin.Constants;MSLogin.Context={whr:"",query_search_params:document.location.search,federated_domain:"",redirect_countdown:Constants.REDIRECT_COUNTDOWN_DEFAULT,redirect_auth_url:"",animationTid:null,redirectTid:null,metrics_on_redirect_submitted:!1,cobranding_image_visible:!1,prefetch_initiated:!1,user_tiles:null,email_discovery_lookup_xhr:null,email_discovery_mode:!1,email_discovery_tiles_mode:!1,email_discovery_response:null,email_discovery_timeout_occurred:!1,email_discovery_splitter_shown:!1,email_discovery_workflow_state:0,email_discovery_easi_user:!1,email_discovery_use_msa_api:!0,cred_height:-1,has_forced_cred_block_height:!1,original_orientation:window.orientation,back_action_stack:new MSLogin.BackActionStack,tenant_branding_tid:null,tenant_branding_retry_count:2e3,tenant_branding_polling_interval:20,tenant_branding_ts:0,authn_forward_state:0,post_from_tile:!1,on_load_image_background_loaded:!1,password_reset_link_url:"",redirect_to_manage:!1,getuserrealmresult:null},MSLogin.Context.username_state={is_empty:!0,is_partial:!1,is_timeout:!1,home_realm_state:0,disable_password:!0,enable_guests:!0,enable_redirect:!1,enable_progress_bar:!1,last_checked_email:""},MSLogin.Context.TenantBranding={key:null,user:null,prev_key:null,prev_obj:null,prev_user:null,prev_boiler_plate_height:0,default_page:!1,whr_key:null,applied:!1,info:null,info_context:null,enabled:!1,has_logo:!1,has_background_img:!1,background_color:Constants.DEFAULT_BACKGROUND_COLOR,footer_height:0,footer_height_saved:!1,cred_height:0,cred_height_saved:!1,workload_branding_saved:!1,workload_branding_illustration:null,workload_branding_illustration_alt:null,workload_branding_logo:null,workload_branding_logo_alt:null,workload_branding_footer_height:0,workload_branding_footer_height_saved:!1,workload_branding_color:null,workload_branding_height:0,workload_branding_enabled:!1,workload_branding_login_cta_text:"",store:new MSLogin.Store,username_hint_changed:!1};var Context=MSLogin.Context;MSLogin.Background={delayed_background_fetch_url:"",background_image_ratio:0,background_image_loaded:!1,background_image_wait:null,winW:-1,winH:460,viewport_height:460,alt_image_path:"",alt_background_path:"",background_resized:!1};var Background=MSLogin.Background;MSLogin.Logo={logo_image_loaded:!1,logo_image_wait:null,winW:-1,winH:159,alt_image_path:"",alt_logo_path:""};var Logo=MSLogin.Logo;MSLogin.Instrument={latency_sensitivity:Constants.LATENCY_SENSITIVITY_DEFAULT,home_realm_start:null,home_realm_load_time:0,prefetch_done:!1,prefetch_start:null,prefetch_load_time:0,background_image_loaded:!1,background_image_start:null,background_image_load_time:0,background_image_error:!1,logo_image_loaded:!1,logo_image_start:null,logo_image_load_time:0,logo_image_error:null,email_discovery_ui_code:0,email_discovery_splitter_choice:0,possible_easi_user:0,tenant_branding_start_time:(new Date).getTime(),tenant_branding_process_end_time:0,tenant_branding_json_end_time:0,tenant_branding_load_error:!1,has_tenant_branding:!1,has_dynamic_tenant_branding:!1,tenant_branding_total_time:0,tenant_branding_number_of_switches:0,tenant_branding_right_side_time:0,logo_image_end_time:0,background_image_end_time:0,document_ready_end_time:0,document_load_end_time:0};var Instrument=MSLogin.Instrument;MSLogin.User={UpdateUsernameState:function(){var e=$.trim($("#cred_userid_inputtext").val());if($("input#cred_userid_inputtext").val(e),Context.username_state.is_empty=!1,Context.username_state.is_partial=!1,e!=Context.username_state.last_checked_email&&(Context.username_state.home_realm_state=Constants.State.NONE),""==e&&(Context.username_state.is_empty=!0,Context.username_state.is_partial=!0,Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1,Context.username_state.home_realm_state=Constants.State.NONE),!Support.validateUsernameCredInput(e))if(Constants.IS_MSA_PHONE_USERNAME_SUPPORTED&&Constants.REGEX_PHONE.test(e))Context.username_state.is_empty=!1,Context.username_state.is_partial=!1,Context.username_state.home_realm_state=Constants.State.NONE;else if(Context.username_state.is_empty=!1,Context.username_state.is_partial=!0,Context.username_state.home_realm_state=Constants.State.NONE,!Constants.IS_NAME_COEXISTENCE_ACCOUNT){var t=30064;null!=e&&e.indexOf("\\")>-1&&(t=30066),Support.showClientError(t)}switch(Context.username_state.is_timeout&&(Context.username_state.is_timeout=!0,Context.username_state.disable_password=!1,Context.username_state.enable_redirect=!1),Context.username_state.home_realm_state){case Constants.State.FEDERATED:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!0;break;case Constants.State.MANAGED:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!1,Context.username_state.enable_redirect=!1;break;case Constants.State.INVALID:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1;break;default:Context.username_state.is_timeout=!1,Context.username_state.disable_password=!0,Context.username_state.enable_redirect=!1}$("#home_realm_discovery").val(Context.username_state.home_realm_state)},IsGuestUser:function(){var e=window.location.href;return null!=e&&(Context.query_search_params.indexOf("guests=1")>-1||Context.query_search_params.indexOf("guest=1")>-1)?!0:!1},UsernameOnChangeHandler:function(){User.UpdateUsernameState(),$("#recover_container").removeClass("hidden"),$("#recover_container").css("opacity",1),Context.username_state.disable_password&&!Constants.IsB2CScenario?$("#cred_sign_in_button").addClass("disabled_button").prop("disabled",!0):$("#cred_sign_in_button").removeClass("disabled_button").prop("disabled",!1),Context.username_state.enable_redirect?($("#cred_password_container").css("opacity",0),$("#cred_password_container").addClass("hidden"),$("#redirect_message_container").removeClass("no_display"),$("#redirect_message_container").css("opacity",1),$("#redirect_message_container").removeClass("hidden"),$(".login_guest_container").css("opacity",0),$("#cred_sign_in_button").css("opacity",0),$("#cred_sign_in_button").addClass("hidden")):($("#cred_password_container").removeClass("hidden"),$("#cred_password_container").css("opacity",1),$("#redirect_message_container").css("opacity",0),$("#redirect_message_container").addClass("hidden"),$("#redirect_message_container").addClass("no_display"),$(".login_guest_container").css("opacity",1),$("#cred_sign_in_button").css("opacity",1),$("#cred_sign_in_button").removeClass("hidden")),Context.username_state.enable_guests&&User.IsGuestUser()?($("#guest_hint_text").show(),$("#alternative-identity-providers").hide(),$(".guest_redirect_container").show()):($("#guest_hint_text").hide(),$(".guest_redirect_container").hide()),Context.username_state.enable_progress_bar||(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"))},setupPrefetching:function(){Context.prefetch_initiated||Support.is_prefetch_supported()&&""!=Constants.PREFETCH_URL&&User.latencySensitivity()>=-1&&(Instrument.prefetch_start=Util.now(),Util.PrefetchContent(Constants.PREFETCH_URL),Context.prefetch_initiated=!0)},onLoadImage:function(){var e=$("#background_background_image");Background.background_image_ratio=Support.isDefined(e)&&Support.isDefined(e[0])&&Support.isDefined(e[0].naturalWidth)&&Support.isDefined(e[0].naturalHeight)&&0!=e[0].naturalHeight?e[0].naturalWidth/e[0].naturalHeight:e.width()/e.height(),Background.background_image_loaded=!0,Util.debug_console("OnLoadImage: Called"),Background.background_resized&&!Context.on_load_image_background_loaded&&User.IsImageLoaded(e)&&(Context.on_load_image_background_loaded=!0,TenantBranding.IsShowingDynamicBranding()?Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper():User.onLoadImageHelper())},onLoadImageHelper:function(){var e=$("#background_background_image");e.hide(),$("#background_background_image_old").remove(),$("#background_page_overlay").css("visibility","visible"),e.show();var t=$("html").css("background-color");$("#background_page_overlay").css("background-color",t),$("#background_page_overlay").show(),$("#background_page_overlay").fadeOut(500,"linear"),Util.debug_console("OnLoadImage: Background was resized.")},updateGuestLink:function(){var e=$("#guest_redirect_link").attr("href");""!=e&&void 0!=e&&(e=User.addFederatedRedirectQSParameters(e),$("#guest_redirect_link").attr("href",e))},forceOrientationResize:function(){Context.original_orientation=-1,User.resize_bg(Context.original_orientation)},setupCredFieldsWithPlaceHolder:function(){function e(e,t){e.css("background",t?"transparent":"#FFFFFF"),e.siblings(".placeholder").css("filter","alpha(opacity={0})".format(t?"100":"0")),e.siblings(".placeholder").css("visibility",t?"visible":"hidden")}var t=$("input#cred_userid_inputtext"),n=$("input#cred_password_inputtext");Constants.IS_HOLOGRAPHIC?(t.keypress(function(e){User.KeyPressEnter(e,Util.OnNext,13)}),n.keypress(function(e){User.KeyPressEnter(e,Util.OnNext,13)})):(t.focus(function(){Context.username_state.enable_redirect&&User.CancelRedirect()}),/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&t.blur(function(){User.forceOrientationResize()}),t.change(function(){User.RefreshDomainState(),User.UsernameOnChangeHandler()}),t.keydown(function(e){User.KeyPressEnter(e,User.RefreshDomainState,13),Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.INIT&&User.KeyPressEnter(e,User.RefreshDomainState,9)}),n.keypress(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$("input#cred_keep_me_signed_in_checkbox").keypress(function(e){User.KeyPressEnter(e,Post.SubmitCreds,13)}),$("input#cred_keep_me_signed_in_checkbox").change(function(){User.updateGuestLink()}),n.click(function(){User.UsernameOnChangeHandler(),Context.username_state.is_empty||Context.username_state.is_partial||User.RefreshDomainState()}),n.blur(function(){User.forceOrientationResize()}),Util.debug_console("placeholder supported: "+Support.is_placeholder_supported()),Support.is_placeholder_supported()||($("input[placeholder]").each(function(){var t=$(this).attr("placeholder"),n=$(this).attr("id"),o="";n&&(o='id="'+n+'_placeholder_span"');var i=$('<span class="placeholder" '+o+">"+t+"</span>").appendTo($(this).parent());$(this).before(i),i.css("position","absolute"),i.css("display","block"),i.addClass("normaltext"),i.click(function(){$(this).siblings("input").focus()}),$(this).attr("placeholder"," "),e($(this),""==$(this).val())}),$("input[placeholder]").focus(function(){e($(this),""==$(this).val())}),$("input[placeholder]").keydown(function(){e($(this),!1)}),$("input[placeholder]").bind("paste",function(){e($(this),!1)}),$("input[placeholder]").keyup(function(){e($(this),""==$(this).val())}),$("input[placeholder]").blur(function(){e($(this),""==$(this).val())}),n.parent().click(function(){User.UsernameOnChangeHandler(),Context.username_state.is_empty||Context.username_state.is_partial||User.RefreshDomainState()})));var o=decodeURIComponent(Util.ExtractQSParam("username")),i=$("#cred_userid_inputtext").val();if(""!=o){var a=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,46})?$/;a.test(o)&&""==i&&$("#cred_userid_inputtext").val(o)}$("#redirect_cta_text").hide()},setupCallToActionMessages:function(){$.each(Constants.GENERIC_ERROR_CODES,function(e,t){$("#cta_client_error_text").append($("<div/>").addClass("client_error_msg").addClass(t.toString()).html(Constants.TokenizedStringMsgs.GENERIC_ERROR.replace("#~#ErrorCode#~#",t)))})},resize_bg:function(e){void 0!=e&&(Context.original_orientation=e),document.body&&document.body.offsetWidth&&(Background.winW=document.body.offsetWidth,Background.winH=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(Background.winW=document.documentElement.offsetWidth,Background.winH=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(Background.winW=window.innerWidth,Background.winH=window.innerHeight);var t=document.documentMode;if(Support.isDefined(document.documentElement)&&Support.isDefined(document.documentElement.clientHeight)&&(Background.viewport_height=document.documentElement.clientHeight),$.browser.msie&&t>=10&&(navigator.userAgent.match(/IEMobile/)&&Background.viewport_height>10?$("td#login_panel_center").css("height",Background.viewport_height-10):$("td#login_panel_center").css("height",Background.winH-10)),!(!Background.background_image_loaded&&null==Background.delayed_background_fetch_url||Background.background_resized&&"undefined"!=typeof window.orientation&&Context.original_orientation==window.orientation||(Context.original_orientation=window.orientation,"1"==Util.ExtractQSParam("popupui")))){Support.showIllustration()&&null!=Background.delayed_background_fetch_url&&($("#background_background_image").error(function(){Instrument.tenant_branding_load_error=!0}),User.UpdateBackground(Background.delayed_background_fetch_url,$("html").css("background-color"))),Util.debug_console("resize_bg Background: "+Background.winW+" x "+Background.winH);var n=Support.getViewport();if(Util.debug_console("resize_bg Viewport: "+n[0]+" x "+n[1]),Util.debug_console("resize_bg JQuery: "+$("body").width()+" x "+$("body").height()),$("img#background_background_image").error(function(){$(this).hide()
}),!Background.background_image_loaded||0==Background.background_image_ratio)return void Util.debug_console("Background image not yet loaded.");var o=$(document).width()-400,i=$(document).height(),a=o,r=Math.round(a/Background.background_image_ratio);$("#background_background_image").width(a),$("#background_background_image").height(r),i>r&&(r=i,a=Math.round(r*Background.background_image_ratio),$("#background_background_image").width(a),$("#background_background_image").height(r)),Background.background_image_loaded&&!Background.background_resized&&(Util.debug_console("Background image loaded!"),Background.background_resized=!0,User.onLoadImage()),Util.debug_console("bg_image: "+a+" x "+r)}},getElementHeightSpacing:function(e,t){var n=0;return n+=$(e).height(),t&&(n+=parseInt($(e).css("padding-top"),10),n+=parseInt($(e).css("padding-bottom"),10)),n},getElementHeightMargin:function(e){var t=0;return t+=parseInt($(e).css("margin-top"),10),t+=parseInt($(e).css("margin-bottom"),10)},doesElementExist:function(e){return null!=$(e).height()},moveFooterToBottom:function(){},latencySensitivity:function(){var e=Constants.LATENCY_SENSITIVITY_DEFAULT,t=Util.ExtractQSParam("bandwidth");switch(t){case"low":e=-1;break;case"high":e=1;break;case"critical":e=-2}return Instrument.latency_sensitivity=e,e},updateClientMetricsMode:function(){switch(Constants.METRICS_MODE){case 0:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!1,Constants.INSTRUMENT_PLT=!1;break;case 1:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!0,Constants.INSTRUMENT_PLT=!1;break;case 2:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!1,Constants.INSTRUMENT_PLT=!1;break;case 3:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!0,Constants.INSTRUMENT_PLT=!1;break;case 4:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!1,Constants.INSTRUMENT_PLT=!0;break;case 5:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!0,Constants.INSTRUMENT_PLT=!0;break;case 6:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!1,Constants.INSTRUMENT_PLT=!0;break;case 7:Constants.SUBMIT_METRICS_ON_REDIRECT=!0,Constants.SUBMIT_METRICS_ON_POST=!0,Constants.INSTRUMENT_PLT=!0;break;default:Constants.SUBMIT_METRICS_ON_REDIRECT=!1,Constants.SUBMIT_METRICS_ON_POST=!1}},instrumentPlt:function(){var e=window.$Config;window.$Api.Json(e.urls.instr.pageload,{pn:e.pgid||"",sc:e.scid||0,hpg:e.hpgid||0,country:e.country,plt:window.performance.timing.loadEventEnd-window.performance.timing.navigationStart})},GetHashedImagePath:function(e){return e},UpdateBackground:function(e,t){if((null==t||""==t||Constants.IS_CXH_REQUEST)&&(t=$("html").css("background-color")),TenantBranding.IsShowingDynamicBranding()?Context.TenantBranding.background_color=t:($("#background_page_overlay").css("background-color",t),$("#background_background_image").css("background-color",t),$("#background_branding_container").css("background-color",t),$("html").css("background-color",t)),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD)return Util.debug_console("Screen size too small to fetch background."),void(Background.delayed_background_fetch_url=e);if($("#background_background_image").error(function(){$(this).show(),Context.TenantBranding.has_background_img=!1,TenantBranding.IsShowingDynamicBranding()&&Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper()}),User.onLoadImage(),Background.delayed_background_fetch_url=null,!Support.showIllustration()||""==e||User.latencySensitivity()<0)Util.debug_console("Image load was cancelled."),$("#background_background_image").css("visibility","hidden"),$("#background_company_name_text").css("opacity",0),Context.on_load_image_background_loaded=!0,Background.background_resized=!1,TenantBranding.IsShowingDynamicBranding()&&Logo.logo_image_loaded&&TenantBranding.onLoadImageHelper(),setTimeout(function(){User.setupPrefetching()},1e3);else{var n=User.GetHashedImagePath(e);Context.on_load_image_background_loaded=!1,Background.background_resized=!1,Context.TenantBranding.has_background_img=!0,$("img#background_background_image").attr("src",n),$("img#background_background_image").css("visibility","visible"),$("#background_company_name_text").css("opacity",0),Util.debug_console("Set background image: "+e),Instrument.background_image_start=Util.now()}Background.background_image_ratio=0,Util.debug_console("Fetched background image.")},UpdateLogo:function(e,t){""==e&&$(".login_workload_logo_container").empty(),Logo.logo_image_loaded=!1,$(".workload_img").remove();var n=User.GetHashedImagePath(e);if(""==e)Constants.IS_CXH_REQUEST||$(".login_workload_logo_container").append($("<h1/>").attr("id","login_workload_logo_text").css("visibility","visible").addClass("workload_img_text").addClass("gianttext").text(Util.htmlDecode(t))),Context.TenantBranding.has_logo=!1,TenantBranding.IsShowingDynamicBranding()?TenantBranding.onLoadLogoHelper():TenantBranding.setUserIdHintAndKmsi(),Util.debug_console("Set logo image failover.");else if(Constants.IS_HOLOGRAPHIC){$("header.body-header img.img-brand").remove(),TenantBranding.IsShowingDynamicBranding()&&(Context.TenantBranding.has_logo=!0),Instrument.logo_image_start=Util.now();var o=$("<img/>").hide().addClass("img-brand").error(TenantBranding.onLoadErrorLogo).attr("id","login_workload_logo_image").attr("alt",Constants.PARTNER_NAME);$("header.body-header").append(o),o.load(function(){Instrument.logo_image_end_time=Util.now(),o.show()}).attr("src",n)}else{var i=$("<img/>");Instrument.logo_image_start=Util.now(),TenantBranding.IsShowingDynamicBranding()?(Context.TenantBranding.has_logo=!0,i.load(function(){TenantBranding.onLoadLogo()}),i.hide()):(i.css("visibility","visible"),i.load(function(){Instrument.logo_image_end_time=Util.now()}),TenantBranding.setUserIdHintAndKmsi()),i.error(function(){TenantBranding.onLoadErrorLogo()}),i.attr("id","login_workload_logo_image").addClass("workload_img").attr("alt",Constants.PARTNER_NAME),$(".login_workload_logo_container").append(i),i=$(".workload_img"),i.attr("src",n),$("#login_workload_logo_text").remove(),Util.debug_console("Set logo image: "+e)}},RefreshDomainState:function(){var e=!1,t=$.trim($("#cred_userid_inputtext").val());return User.UpdateUsernameState(),Support.UpdatePasswordResetLink(),"strongauthcheck.2.0"===$("meta[name=PageID]").attr("content")||"proofup.2.0"===$("meta[name=PageID]").attr("content")||"i5028.2.0"===$("meta[name=PageID]").attr("content")?!1:(Context.username_state.is_empty||Context.username_state.is_partial?e=!1:(t!==Context.username_state.last_checked_email||Constants.IS_HOLOGRAPHIC)&&(e=!0),e?User.CheckUser():TenantBranding.RefreshDomainState(t),e)},CheckUser:function(){Constants.IS_NAME_COEXISTENCE_ACCOUNT||(EmailDiscovery.ShouldPerformDiscovery()?EmailDiscovery.PerformEmailBasedDiscovery():User.PerformHomeRealmDiscovery())},PerformHomeRealmDiscovery:function(){if(Context.username_state.home_realm_state!=Constants.State.PENDING){var e=$.trim($("input#cred_userid_inputtext").val());Constants.REGEX_PHONE.test(e)&&(e=e.replace(/\D/g,"")),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500),Context.username_state.enable_progress_bar=!0;var t=Constants.Use_Client_Check_Msa_Flag?Constants.IS_MSA_FED_SUPPORTED:!0;$.ajax({headers:{Accept:"application/json"},url:Constants.REALM_RESOLVER_URL+encodeURI("?user="+e),dataType:"json",data:{"api-version":"2.1",stsRequest:Constants.CONTEXT,checkForMicrosoftAccount:t},beforeSend:function(){Instrument.home_realm_start=Util.now()},success:User.ReceiveTenantInfo,error:User.ReceivedHomeRealmError}),Context.username_state.home_realm_state=Constants.State.PENDING,Context.username_state.last_checked_email=e,User.resize_bg()}},showGenericError:function(e){Support.hideClientErrorMessages(),Support.hideClientMessages(),Support.showClientError(e)},ReceivedHomeRealmError:function(e,t){$("div.progress").css("visibility","hidden"),$("input#cred_password_inputtext").focus(),Util.debug_console("Received home realm error"),Context.username_state.home_realm_state=Constants.State.NONE,clearInterval(Context.animationTid),Context.username_state.home_realm_state=Constants.State.NONE,User.UsernameOnChangeHandler(),"parsererror"==t&&User.showGenericError(ErrorCodes.PARSE_ERROR)},ReceiveTenantCustom:function(e){tenant_info.background_color=e.BackgroundColor,tenant_info.background_url=e.BackgroundPath,tenant_info.logo_url=e.LogoPath,tenant_info.boilerplate1=e.BoilerPlate1,tenant_info.boilerplate2=e.BoilerPlate2,tenant_info.cta1=e.CTA1,tenant_info.cta2=e.CTA2,Util.debug_console(e.LogoPath),clearInterval(Context.animationTid),Context.username_state.home_realm_state=Constants.State.MANAGED,User.UsernameOnChangeHandler(),$("#cred_userid_inputtext").blur(),Constants.IS_HOLOGRAPHIC||$("#cred_password_inputtext").focus(),setTimeout(User.resize_bg,300)},KeyPressEnter:function(e,t,n,o){var i;if(e&&e.which?i=e.which:window.event&&(e=window.event,i=e.keyCode),i===n){if(o&&o>0){MSLogin.User.KeyPressEnterHandleOnceDelayTable=MSLogin.User.KeyPressEnterHandleOnceDelayTable||{};var a=e.timeStamp;if(MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]){var r=MSLogin.User.KeyPressEnterHandleOnceDelayTable[n];if(o>a-r)return n;MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]=a}else MSLogin.User.KeyPressEnterHandleOnceDelayTable[n]=a}t()}return i},StartRedirection:function(e){return Context.redirect_countdown=Constants.REDIRECT_COUNTDOWN_DEFAULT,e&&"none"===$("#cred_userid_container").css("display")||void 0==$("#cred_userid_container").css("display")?void 0:(Util.EnableEmailDiscoveryIfEBD(),$("#cred_cancel_button").hide(),Context.username_state.enable_progress_bar=!0,Context.username_state.enable_redirect=!0,Context.username_state.enable_guests=!1,$("#cred_password_container").css("opacity",0),User.UsernameOnChangeHandler(),Context.redirectTid=setTimeout(function(){User.ShowRedirect(),$("a#redirect_cancel_link").focus()},100),Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST||$("#cred_sign_in_button").hide(),Context.redirectTid)},ReceiveTenantInfo:function(e){if($(".30065,.30068").is(":visible")&&(Support.hideClientError(30065),Support.hideClientError(30068)),e.IsCrossCloud)return Context.username_state.home_realm_state=Constants.State.MANAGED,void MSLogin.Post.SubmitUsername();var t=!0,n=!1;if(Instrument.home_realm_load_time=Util.now()-Instrument.home_realm_start,Context.username_state.enable_progress_bar=!1,Context.username_state.disable_password=!1,Context.username_state.last_checked_email=e.Login,1==Constants.SPLIT_VIEW_ENABLED&&1==Constants.IS_MSA_FED_SUPPORTED&&Constants.HAS_ERROR!==!0)if(0===e.MicrosoftAccount&&e.DomainName!==Context.whr){if(e.NameSpaceType==Constants.NameSpaceType.MANAGED||e.NameSpaceType==Constants.NameSpaceType.FEDERATED&&!Util.isMSA(e.AuthURL))return Context.getuserrealmresult=e,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),void MSLogin.SplitterControl.Render();e.NameSpaceType==Constants.NameSpaceType.UNKNOWN&&MSLogin.SplitterControl.LoginMSA()}else if(void 0===e.MicrosoftAccount||2===e.MicrosoftAccount)return Context.getuserrealmresult=e,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),void MSLogin.SplitterControl.Render();e.NameSpaceType==Constants.NameSpaceType.FEDERATED?e.federation_protocol==Constants.FederationProtocol.SAML20&&null!=e.federation_saml_request?t=MSLogin.User.PostToSamlIdp(e):0!==e.MicrosoftAccount&&Util.isMSA(e.AuthURL)?(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"),t=Support.showUsernameOrDomainError(Util.htmlEncode(e.Login)),n=!0,Context.username_state.home_realm_state=Constants.State.INVALID):(Context.back_action_stack.AddAction(MSLogin.Constants.CancelAction.FROM_REDIRECT_TO_LOGIN),t=MSLogin.User.ReceiveFederatedDomain(e)):e.NameSpaceType==Constants.NameSpaceType.MANAGED?t=MSLogin.User.ReceiveManagedDomain(e):e.NameSpaceType==Constants.NameSpaceType.UNKNOWN&&0!==e.MicrosoftAccount?(clearInterval(Context.animationTid),$("div.progress").css("visibility","hidden"),t=Support.showUsernameOrDomainError(Util.htmlEncode(e.Login)),n=!0,Context.username_state.home_realm_state=Constants.State.INVALID):t=MSLogin.User.ReceiveUnknownDomain(e),Constants.IS_HOLOGRAPHIC?(!t||n)&&Util.OnBack():t&&($("#cred_userid_inputtext").blur(),$("#cred_password_inputtext").focus())},ReceiveUnknownDomain:function(e){if(1==e.State&&!e.FederationGlobalVersion)return Context.username_state.home_realm_state=Constants.State.INVALID,User.UsernameOnChangeHandler(),Util.debug_console("federationGlobalVersion bad"),$("#cred_password_inputtext").blur(),$("#cred_userid_inputtext").focus(),!1;var t=!Support.showUsernameOrDomainError(Util.htmlEncode(e.Login));return Context.username_state.home_realm_state=Constants.State.INVALID,clearInterval(Context.animationTid),Constants.IS_HOLOGRAPHIC||User.UsernameOnChangeHandler(),Util.debug_console("Unknown home realm reply"),$("input#cred_password_inputtext").focus(),t},ReceiveFederatedDomain:function(e){return Context.username_state.home_realm_state=Constants.State.FEDERATED,tenant_info.company_name="",tenant_info.domain=e.DomainName,Context.authn_forward_state=e.AuthNForwardType,e.DomainName.areEqualIgnoreCase(Constants.MSA_DOMAIN)&&!Constants.IS_MSA_FED_SUPPORTED?($(".pip").stop(!0,!0),$(".pip").hide(),clearInterval(Context.animationTid),Context.username_state.enable_redirect=!1,Context.username_state.home_realm_state=Constants.State.INVALID,Context.back_action_stack.RemoveLastCancelAction(),Support.showClientError(30065),!1):e.DomainName!=Context.whr||User.IsGuestUser()?(Context.federated_domain=e.DomainName,Context.redirect_auth_url=e.AuthURL,e.TenantBrandingInfo&&e.TenantBrandingInfo.length&&(TenantBranding.StoreBrandingInfo(e.DomainName,e.TenantBrandingInfo),TenantBranding.getTenantBrandingContext(e.TenantBrandingInfo,Constants.LCID).KeepMeSignedInDisabled&&($("#cred_kmsi_container").hide(),$("#cred_keep_me_signed_in_checkbox").attr("checked",!1))),Util.updateRedirectionMessage(e.AuthURL),e.federation_protocol==Constants.FederationProtocol.SAML20&&null!=e.federation_saml_request?(MSLogin.User.PostToSamlIdp(e),!1):(1==e.FederationGlobalVersion&&User.Redirect(User.addFederatedRedirectQSParameters(e.AuthURL)),User.StartRedirection(!1),!1)):(Context.username_state.home_realm_state=Constants.State.MANAGED,Util.debug_console("whr set already"),User.UsernameOnChangeHandler(),$("#cred_userid_inputtext").blur(),$("#cred_password_inputtext").focus(),Context.back_action_stack.RemoveLastCancelAction(),!1)},ReceiveManagedDomain:function(e){return Context.whr=void 0!=e.DomainName?e.DomainName:e.Login.split("@@")[1],null!=e.TenantBrandingInfo&&TenantBranding.StoreBrandingInfo(e.DomainName,e.TenantBrandingInfo),TenantBranding.PerformDynamicBranding(e.DomainName),Context.TenantBranding.user=e.Login,Context.username_state.home_realm_state=Constants.State.MANAGED,tenant_info.company_name=e.FederationBrandName,tenant_info.domain=e.DomainName,tenant_info.BackgroundColor=$("#background_branding_container").css("background"),tenant_info.BackgroundPath=$("#background_background_image").attr("src"),tenant_info.LogoPath=$("#login_workload_logo_image").attr("src"),tenant_info.BoilerPlate1="",tenant_info.BoilerPlate2="",tenant_info.CTA1=$("#login_cta_text").text(),tenant_info.CTA2="",tenant_info.HadBoilerPlate=!1,Context.username_state.disable_password=!1,Context.username_state.enable_progress_bar=!1,Context.username_state.enable_redirect=!1,User.UsernameOnChangeHandler(),User.TriggerUserDomainHintChanged(e),!0},PostToSamlIdp:function(e){if(Context.federated_domain=e.DomainName,Context.redirect_auth_url=e.AuthURL,$("#samlform").attr("action",e.AuthURL),$("#samlrequest").val(decodeURIComponent(e.federation_saml_request)),null!=e.federation_saml_request)$("#samlrelaystate").val(decodeURIComponent(e.federation_saml_relay_state));else{var t=Constants.FEDERATION_QUERY_PARAMETERS.qs("wctx");$("#samlrelaystate").val(decodeURIComponent(t))}$("#samlform").submit()},Redirect:function(e){window.location.assign(e)},GetRedirectAction:function(e,t,n,o){var i;return Constants.IS_MSA_REDIR_SUPPORTED?(o&&("FormPost"===Constants.responseMode?n.username=o:t=Util.appendQueryString(t,"username="+encodeURIComponent(o))),i=User.GetRedirectWithOAuthResponseMode(Constants.responseMode,t,n)):(o&&(e=Util.appendQueryString(e,"username="+encodeURIComponent(o))),i=function(){window.location.assign(e)}),i},GetRedirectWithOAuthResponseMode:function(e,t,n){var o;return o="FormPost"===e&&Constants.useFormPostResponseMode?function(){var e=$("<form />",{method:"post",action:t});e.append($.map(n,function(e,t){return $("<input>",{type:"hidden",name:t,value:e})})),$("body").append(e),e.submit()}:function(){window.location.assign(t)}},ShowRedirect:function(){$("#signin_legend,#boilerplate_container,#body_header,#page_footer,#footer_content").hide(),$(".control-page").addClass("page_centered");var e;if(e=Constants.IS_MSA_REDIR_SUPPORTED&&Util.isMSA(Context.redirect_auth_url)?User.GetRedirectAction(null,Constants.appRedirectUrl,Constants.msaRedirErrorParams,User.getUsernameFromPage()):User.addFederatedRedirectQSParameters(Context.redirect_auth_url),Constants.SUBMIT_METRICS_ON_REDIRECT&&!Context.metrics_on_redirect_submitted&&(Post.SubmitInstrumentation(),Context.metrics_on_redirect_submitted=!0),Context.username_state.enable_guests=!1,User.UsernameOnChangeHandler(),0==Context.redirect_countdown)return MSLogin.Util.LogCxhTelemetry("AADLoginPageFederationRedirect"),Constants.FLOW_TOKEN.length>0&&Util.setCookieWithExpiration(Constants.FLOW_TOKEN_COOKIE_NAME,Constants.FLOW_TOKEN),void("function"==typeof e?e():User.Redirect(e));1==Context.redirect_countdown&&$("#background_page_overlay").css("z-index",0),$("#cred_userid_container,#cred_password_container,.login_cta_container,#recover_container,input#cred_password_inputtext").hide(),$("#redirect_cta_text").show(),$("#redirect_company_name_text").empty();var t=$("#redirect_message_container");if(t.length>0){var n=t.show().css("visibility","visible").css("opacity",1)[0];n&&n.removeAttribute("aria-hidden")}$("#windows_redirect_message_container").show(),$("#progress_text").focus(),Context.redirect_countdown=Context.redirect_countdown-1,Context.redirectTid=setTimeout(function(){User.ShowRedirect()},1e3),Util.debug_console("Redirecting in "+Context.redirect_countdown)},CancelRedirect:function(){clearTimeout(Context.redirectTid),User.tryShowCancelButton(),$("#cred_kmsi_container").show(),$("#cred_userid_container").show(),$("#cred_password_container").show(),$(".login_cta_container").show(),$("#credentials .login_cta_container").hide(),$("#recover_container").show(),$("#redirect_cta_text").hide(),$("#cred_password_container").css("opacity",1),$("input#cred_password_inputtext").css("display","inline-block"),$("#redirect_message_container").hide(),$("input#cred_password_inputtext").blur(),$("#redirect_company_name_text").empty(),Context.username_state.home_realm_state==Constants.State.FEDERATED&&(Context.username_state.home_realm_state=Constants.State.NONE),Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,Context.username_state.disable_password=!0,Context.username_state.enable_progress_bar=!1,Context.username_state.enable_redirect=!1,Context.username_state.enable_guests=!0,User.UsernameOnChangeHandler(),$("input#cred_userid_inputtext").focus()},startAnimation:function(e){var t=100,n=$(".login_footer_container").outerWidth();e&&(n=e.outerWidth()),$(".pip").stop(!0,!0),$(".pip").each(function(){User.animatePip($(this),t,n),t+=100})},animatePip:function(e,t,n){var o=n/3,i=n-3;"ltr"==Constants.DIR?e.css("left",0).hide().delay(t).show().animate({left:o},{duration:1e3,easing:"easeOutSine"}).animate({left:i},{duration:999,easing:"easeInSine"}):e.css("right",0).hide().delay(t).show().animate({right:o},{duration:1e3,easing:"easeOutSine"}).animate({right:i},{duration:999,easing:"easeInSine"})},addFederatedRedirectQSParameters:function(e){var t=e;if(Util.isMSA(e)){e=Constants.MSA_AUTH_URL;var n=decodeURIComponent(Util.ExtractQSParam("pcexp")),o=decodeURIComponent(Util.ExtractQSParam("display"));o.areEqualIgnoreCase("popup")&&(n=!1),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD&&(n=!1),e.indexOf("pcexp")<0?e+="&pcexp="+encodeURIComponent(n):Constants.IS_CXH_REQUEST||(e=e.replace(/pcexp=[^&]*/i,"pcexp="+encodeURIComponent(n)));var i=decodeURIComponent(Util.ExtractQSParam("vv"));i&&(e.indexOf("vv")<0?e+="&vv="+encodeURIComponent(i):e=e.replace(/vv=[^&]*/i,"vv="+encodeURIComponent(i))),e.indexOf("username")<0&&(e=User.addUsernameQsParam(e))}User.resize_bg();var a=decodeURIComponent(Util.ExtractQSParam("popupui"));(Constants.IS_ADAL_REQUEST||Background.winW<Constants.MOBILE_WIDTH_THRESHOLD)&&(a=1),e.indexOf("popupui")<0?e+="&popupui="+encodeURIComponent(a):e=e.replace(/popupui=[^&]*/i,"popupui="+encodeURIComponent(a)),e=e.replace(/guests%3D1/i,"");var r=t.qs("LoginOptions");if(""==r&&(r=$("#cred_keep_me_signed_in_checkbox").attr("checked")?"1":""),""!==r){var s=e.qs("wreply");""!=s?(s+=(s.indexOf("%3f")>=0?"%26":"%3f")+"LoginOptions%3d"+r,e=e.qs("wreply",s)):(s=e.qs("wctx"),""!=s&&(s+="%26LoginOptions%3d"+r,e=e.qs("wctx",s))),e=e.qs("LoginOptions",r)}return e},RegisterOnLoadImage:function(){$("#background_background_image").load(function(){void 0!=this.width&&(Background.background_image_loaded=!0),User.onLoadImage(),0==Instrument.background_image_end_time&&(Instrument.background_image_end_time=Util.now()),Instrument.background_image_load_time=Util.now()-Instrument.background_image_start,Instrument.background_image_loaded=!0,setTimeout(function(){User.setupPrefetching()},1e3),User.resize_bg()}).error(function(){$("#background_background_image").hide(),Instrument.background_image_loaded=!1,Instrument.background_image_load_time=Util.now()-Instrument.background_image_start,Instrument.background_image_error=!0,0==Instrument.background_image_end_time&&(Instrument.background_image_end_time=Util.now())})},IsImageLoaded:function(e){if(void 0==e||null==e||void 0==e[0]||null==e[0]||void 0==e[0].complete||null==e[0].complete)return!1;var t=e[0],n=document.documentMode;return t.complete||$.browser.msie&&8>=n?"undefined"!=typeof t.naturalWidth&&0==t.naturalWidth?!1:"undefined"!=typeof t.naturalHeight&&0==t.naturalHeight?!1:!0:!1},isChxOrAdalOverride:function(){return Constants.IS_CXH_REQUEST||Constants.IS_ADAL_REQUEST&&Constants.ADAL_UX_OVERRIDE},getUsernameFromPage:function(){var e=decodeURIComponent(Util.ExtractQSParam("username")),t=$("#cred_userid_inputtext").val();return t?t:e?e:""},addUsernameQsParam:function(e){var t=User.getUsernameFromPage();return t&&(e=Util.appendQueryString(e,"username="+encodeURIComponent(t))),e},shouldShowCancelButton:function(){var e=("FRX"===Constants.CxhFlow||"MOSET"===Constants.CxhFlow)&&!Constants.IS_HOLOGRAPHIC,t=Constants.IS_ADAL_REQUEST&&!Constants.ADAL_UX_OVERRIDE,n=Context.back_action_stack.DoesCancelActionExist(),o=Tiles.users&&Tiles.users.length&&"other"!==Tiles.users[0].link&&Constants.IS_USE_OTHER_ACCOUNT_VISIBLE;return e||t||n||o},tryShowCancelButton:function(){User.shouldShowCancelButton()?$("#cred_cancel_button").show():$("#cred_cancel_button").hide()},RegisterOnUserDomainHintChanged:function(e){$(document).on(Constants.USER_DOMAIN_HINT_CHANGED_EVENT_NAME,e)},TriggerUserDomainHintChanged:function(e){$(document).trigger(Constants.USER_DOMAIN_HINT_CHANGED_EVENT_NAME,[e])}};var User=MSLogin.User;window.$Do&&window.$Do.register("User"),MSLogin.SplitterControl={Template:'<a id="{1}_link" href="#" onclick="{0}(); return false;" tabindex="1" class="tile_link tooltip">    <table id="{1}" class="user_tile">        <tbody>        <tr class="{1}" style="cursor: pointer">            <td>                <img class="ad_glyph {1}" src="{2}" alt="{3}">            </td>            <td class="tile_name">                <div class="bigtext tile_primary_name windows_tile_text wrap {1}" style="cursor: pointer">{3}</div>                <div class="smallertext tile_secondary_name  windows_tile_text text-caption2 {1}" style="cursor: pointer">{4}</div>                <div class="smallertext tile_third_name  windows_tile_text text-caption2 {1}" style="cursor: pointer">{5}</div>             </td>         </tr>         </tbody>    </table></a>',Render:function(){if(Constants.MEMBER_NAME===Context.username_state.last_checked_email&&$(".view-error-details-container:visible").length)return $("div.progress").css("visibility","hidden"),Context.username_state.home_realm_state==Constants.State.PENDING&&(Context.username_state.home_realm_state=Constants.State.MANAGED),void $("#cred_password_inputtext").focus();if($(".login_cred_field_container").hide(),$(".login_cred_container .windows_cred_block").hide(),$(".login_cred_options_container").hide(),$(".login_user_chooser").hide(),$("#cta_error_message_text").hide(),User.tryShowCancelButton(),$(".login_cred_options_container").show(),$("#cred_sign_in_button").hide(),$("#recover_container").hide(),$("#alternative-identity-providers").hide(),$("#cred_kmsi_container").hide(),0!=Context.getuserrealmresult.MicrosoftAccount||Context.getuserrealmresult.NameSpaceType!=Constants.NameSpaceType.MANAGED&&(Context.getuserrealmresult.NameSpaceType!=Constants.NameSpaceType.FEDERATED||Util.isMSA(Context.getuserrealmresult.AuthURL)))Support.showClientMessage(30140);else{var e=$("input#cred_userid_inputtext").val().toLowerCase();e=$.trim(e);var t=Constants.TokenizedStringMsgs.UPN_DISAMBIGUATE_MESSAGE.replace("{0}",e);$("#upn_needs_disambiguation_text").text(t),Support.showClientMessage(30139)}$.each(Constants.SplitterControlData,function(e,t){var n=MSLogin.SplitterControl.Template.format(t.link,t.id,t.image,t.name,t.login,MSLogin.Util.htmlEncode(Context.username_state.last_checked_email));$("#splitter-tiles-container").append(n)}),$("#login-splitter-control").show(),$("#disambig-container").show(),$("#splitter-tiles-container").show()},LoginAAD:function(){Context.username_state.home_realm_state=Constants.State.MANAGED,$(".login_cred_options_container").show(),$("#cred_sign_in_button").show(),User.tryShowCancelButton(),$("#recover_container").show(),$("#alternative-identity-providers").show(),$("#cred_kmsi_container").show(),$("#cred_sign_in_button").removeClass("disabled_button").prop("disabled",!1),$("#splitter-tiles-container").empty(),$("#splitter-tiles-container").hide(),$("#disambig-container").hide(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_container .windows_cred_block").show(),Support.hideClientErrorMessages(),Support.hideClientMessages();var e=Context.getuserrealmresult;null!=e&&(e.NameSpaceType==Constants.NameSpaceType.FEDERATED?(Context.back_action_stack.AddAction(MSLogin.Constants.CancelAction.FROM_REDIRECT_TO_DISAMBIGUATION_SCREEN),User.ReceiveFederatedDomain(e)):(Context.back_action_stack.AddAction(MSLogin.Constants.CancelAction.FROM_LOGIN_TO_DISAMBIGUATION_SCREEN),User.ReceiveManagedDomain(e))),Support.showClientMessage(1),$("#cred_userid_container").show(),$("div.progress").css("visibility","hidden"),$("#cred_password_inputtext").focus()},LoginMSA:function(){Context.username_state.home_realm_state=Constants.State.FEDERATED,$("#splitter-tiles-container").empty(),$("#splitter-tiles-container").hide(),$("#disambig-container").hide(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),Support.hideClientErrorMessages(),Support.hideClientMessages();var e={DomainName:Constants.MSA_DOMAIN,AuthURL:Constants.MSA_AUTH_URL};Context.back_action_stack.AddAction(MSLogin.Constants.CancelAction.FROM_REDIRECT_TO_DISAMBIGUATION_SCREEN),User.ReceiveFederatedDomain(e)}};var tenant_info={company_name:"",cta1:"",cta2:"",boilerplate1:"",boilerplate2:"",background_url:"",background_color:"",logo_url:"",domain:"",lang:""};$(pageOnReady),$(window).load(function(){if(Support.renderBrowserSpecific(),User.updateClientMetricsMode(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),!Constants.IS_HOLOGRAPHIC&&!Constants.SSPR&&!Constants.StrongAuth){var e=$("input#cred_userid_inputtext"),t=$("input#cred_password_inputtext");e.length&&-1!==e.val().indexOf("@")?EmailDiscovery.ShouldPerformDiscovery()?($("#cred_continue_button").focus(),$("#redirect_message_container").hide(),$("#alternative-identity-providers").hide()):(Context.username_state.home_realm_state=Constants.State.MANAGED,User.UsernameOnChangeHandler(),Util.debug_console("startup"),(Constants.IS_CXH_REQUEST&&!Constants.IS_MOBILE||!Constants.IS_CXH_REQUEST)&&(e.val()?t.focus():e.focus())):(User.UsernameOnChangeHandler(),(Constants.IS_CXH_REQUEST&&!Constants.IS_MOBILE||!Constants.IS_CXH_REQUEST)&&(e.val()?t.focus():e.focus())),Constants.userRealmInfo&&(Context.getuserrealmresult=Constants.userRealmInfo,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_DISAMBIGUATION_SCREEN_TO_LOGIN),Context.username_state.last_checked_email=Constants.MEMBER_NAME,MSLogin.SplitterControl.Render())}if(Util.EnableEmailDiscoveryIfEBD(),"1"==Util.ExtractQSParam("popupui")){try{var n=$("meta[name=viewport]");n.attr("content","width=300, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, height=device-height")}catch(o){}$("html").css("background-color","#FFFFFF"),$("body").css("background-color","#FFFFFF"),$("#background_branding_container").css("background-color","#FFFFFF")}window.performance&&window.performance.timing&&Constants.INSTRUMENT_PLT&&setTimeout(User.instrumentPlt,0),Constants.OnPremPasswordValidationConfig&&Constants.OnPremPasswordValidationConfig.IsPollingEnabled&&Constants.OnPremPasswordValidationConfig.IsPollingRequired&&(MSLogin.MSOnPremPasswordValidation=new MSLogin.MSOnPremPasswordValidation,MSLogin.MSOnPremPasswordValidation.startPolling()),Instrument.document_load_end_time=Util.now()}),MSLogin.EmailDiscovery={Strings:{},WorkflowStates:{NONE:0,INIT:1,LOOKING:2,SPLITTER:3,MSA:4,AAD:5},is_enabled_workflow:!1,IsDiscoveryPage:function(){return EmailDiscovery.is_enabled_workflow},ShouldPerformDiscovery:function(){return Context.email_discovery_mode},IsTilesModeActivated:function(){return Context.email_discovery_tiles_mode},Init:function(){Context.email_discovery_mode=!0,EmailDiscovery.ShouldPerformDiscovery()&&(EmailDiscovery.is_enabled_workflow=!0),$("#cred_sign_in_button").hide(),$("#cred_cancel_button").hide(),$("#cred_kmsi_container").hide(),$("#recover_container").hide(),$("#cred_password_container").hide(),$("#login_cta_text").hide(),$("#login_user_chooser").hide(),$("#forget_tile_container").hide(),$("#guest_hint_text").hide(),$(".guest_redirect_container").hide(),$(".login_cta_container").show(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$("#looking_container").hide(),$("div.progress").css("visibility","hidden"),Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",Context.username_state.home_realm_state=Constants.State.NONE,Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE;var e=decodeURIComponent(Util.ExtractQSParam("username")),t=$("#cred_userid_inputtext").val();EmailDiscovery.IsTilesModeActivated()&&e!==t&&($("input#cred_userid_inputtext").val(""),$("input#cred_userid_inputtext").focus()),EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery()},Initialize:function(){$("input#cred_userid_inputtext").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput()},13)}),$("#cred_continue_button").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput(),User.RefreshDomainState()},13)}),$("#cred_try_again_button").keydown(function(e){EmailDiscovery.ShouldPerformDiscovery()&&User.KeyPressEnter(e,function(){e.preventDefault(),EmailDiscovery.ValidateUserInput(),User.RefreshDomainState()
},13)}),$("#iDisambigRenameLink").click(function(e){e.preventDefault(),window.open(Constants.DisambigHelpUrl,"_blank")}),$("a#looking_cancel_link").click(function(e){e.preventDefault(),Context.back_action_stack.TriggerCancelAction()})},SetupTilesForSplitter:function(){window.users!=Constants.EMAIL_DISCOVERY_DEFAULT_TILES&&(Context.email_discovery_splitter_shown=!0,Context.user_tiles=Tiles.users,Tiles.users=Constants.EMAIL_DISCOVERY_DEFAULT_TILES,window.users=Tiles.users,$.each(window.users,function(e,t){t.ignore_length=!0}))},RevertUserTiles:function(){window.users==Constants.EMAIL_DISCOVERY_DEFAULT_TILES&&(Context.email_discovery_splitter_shown=!1,Tiles.users=Context.user_tiles,window.users=Tiles.users)},ShowPostErrorMessage:function(){Context.email_discovery_mode=!1,EmailDiscovery.is_enabled_workflow=!0,Context.email_discovery_splitter_shown=!1,-1==$("meta[name=PageID]").attr("content").indexOf("EmailBasedDiscoveryTiles")&&Context.back_action_stack.AddAction(Constants.CancelAction.FROM_MANY_TO_EMAILDISCOVERY_INIT),$("#cred_cancel_button").show()},ValidateUserInput:function(){User.UpdateUsernameState(),Context.username_state.is_empty?(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,EmailDiscovery.ShowEmailDiscovery(30127)):Context.username_state.is_partial&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,EmailDiscovery.ShowEmailDiscovery(30145))},PerformEmailBasedDiscovery:function(){var e=$("input#cred_userid_inputtext").val().toLowerCase();if(e=$.trim(e),Context.email_discovery_timeout_occurred=!1,Context.email_discovery_error_message=null,!Support.validateUsernameCredInput(e))return Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.NONE,void EmailDiscovery.ShowEmailDiscovery(30064);var t=Constants.Use_Client_Check_Msa_Flag?Constants.IS_MSA_FED_SUPPORTED:!0;Context.email_discovery_lookup_xhr=$.ajax({headers:{Accept:"application/json"},url:Constants.EMAIL_DISCOVERY_SERVICE_URI.replace("{0}",encodeURI(e)),dataType:"json",data:{stsRequest:Constants.CONTEXT,checkForMicrosoftAccount:t},success:EmailDiscovery.ReceiveHomeRealmInfo,error:EmailDiscovery.ReceiveHomeRealmError,timeout:Constants.EMAIL_DISCOVERY_SERVICE_TIMEOUT}),Context.username_state.last_checked_email=e,Context.username_state.home_realm_state=Constants.State.PENDING,MSLogin.EmailDiscovery.HideEmailDiscovery(),MSLogin.EmailDiscovery.ShowLookingForAccountLayout()},ReceiveHomeRealmInfo:function(e){Context.email_discovery_response={AAD:e},EmailDiscovery.HideLookingForAccountLayout(),Context.back_action_stack.RemoveLastCancelAction();var t=EmailDiscovery.GetAccountStateFromResponse({AAD:e});EmailDiscovery.PerformUIAction(t)},GetAccountStateFromResponse:function(e){var t=Constants.EmailDiscoveryAccountState;if(null===e||null===e.AAD)return Context.username_state.home_realm_state=Constants.State.INVALID,t.ERROR;var n=e.AAD.MicrosoftAccount,o=e.AAD,i="",a="";if(null===n)i="TIMED_OUT";else if(i=EmailDiscovery.GetEnumKeyName(Constants.MSAccount,n),null===i)return t.ERROR;if("timeout"===o)a="TIMED_OUT",Context.username_state.home_realm_state=Constants.State.INVALID;else{a=EmailDiscovery.GetEnumKeyName(Constants.NameSpaceType,o.NameSpaceType);var r=o.NameSpaceType===Constants.NameSpaceType.FEDERATED&&!o.AuthURL;if(null===a||r)return Context.username_state.home_realm_state=Constants.State.INVALID,t.ERROR;Context.username_state.home_realm_state=Constants.State[a]}var s="AAD_"+a+"_AND_MSA_"+i,d=t[s];return void 0===d?t.Error:d},PerformUIAction:function(e){var t=Constants.EmailDiscoveryAccountState,n=Context.email_discovery_response;if(n.AAD.IsCrossCloud)return Context.username_state.home_realm_state=Constants.State.MANAGED,void MSLogin.Post.SubmitUsername();switch(Context.email_discovery_easi_user=!1,Context.email_discovery_splitter_shown=!1,Instrument.email_discovery_ui_code=e,e){case t.AAD_UNKNOWN_AND_MSA_NOT_EXIST:Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show(),EmailDiscovery.ShowEmailDiscovery(30146);break;case t.AAD_UNKNOWN_AND_MSA_EXISTS:Context.email_discovery_easi_user=!0,EmailDiscovery.LoginMSOAccount();break;case t.AAD_FEDERATED_AND_MSA_NOT_EXIST:if(Util.isMSA(n.AAD.AuthURL)){Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show(),EmailDiscovery.ShowEmailDiscovery(30146);break}case t.AAD_MANAGED_AND_MSA_NOT_EXIST:EmailDiscovery.LoginAADAccount();break;case t.AAD_FEDERATED_AND_MSA_EXISTS:if(Util.isMSA(n.AAD.AuthURL)){EmailDiscovery.LoginMSOAccount();break}EmailDiscovery.SetupTilesForSplitter(),Context.redirect_auth_url=n.AAD.AuthURL,Context.federated_domain=n.AAD.DomainName,window.users[0].authUrl=n.AAD.AuthURL;case t.AAD_MANAGED_AND_MSA_EXISTS:Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),$("#cred_cancel_button").show(),EmailDiscovery.ShowSplitter();break;case t.AAD_FEDERATED_AND_MSA_THROTTLED:case t.AAD_FEDERATED_AND_MSA_TIMED_OUT:EmailDiscovery.SetupTilesForSplitter(),Context.redirect_auth_url=n.AAD.AuthURL,Context.federated_domain=n.AAD.DomainName,window.users[0].authUrl=n.AAD.AuthURL,Context.email_discovery_timeout_occurred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),EmailDiscovery.ShowSplitter();break;case t.AAD_MANAGED_AND_MSA_THROTTLED:case t.AAD_MANAGED_AND_MSA_TIMED_OUT:Context.email_discovery_timeout_occurred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START),EmailDiscovery.ShowSplitter();break;case t.AAD_TIMED_OUT_AND_MSA_THROTTLED:case t.AAD_TIMED_OUT_AND_MSA_TIMED_OUT:case t.AAD_UNKNOWN_AND_MSA_THROTTLED:case t.AAD_UNKNOWN_AND_MSA_TIMED_OUT:case t.AAD_TIMED_OUT_AND_MSA_NOT_EXIST:case t.ERROR:Constants.SHOULD_HIDE_SIGNUP||$("#create_msa_account_container").show();case t.AAD_TIMED_OUT_AND_MSA_EXISTS:default:Context.email_discovery_timeout_occurred=!0,Context.email_discovery_use_msa_api?Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_TO_EMAILDISCOVERY_START):EmailDiscovery.IsTilesModeActivated()&&Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_SPLITTER_FALLBACK_TO_TILES),EmailDiscovery.ShowSplitter()}Context.email_discovery_easi_user&&(Instrument.possible_easi_user=1)},ReceiveHomeRealmError:function(e,t){"abort"==t?(EmailDiscovery.HideLookingForAccountLayout(),EmailDiscovery.ShowEmailDiscovery()):(Context.back_action_stack.RemoveLastCancelAction(),EmailDiscovery.HandleTimeoutHomeRealmInfo())},HandleTimeoutHomeRealmInfo:function(){Context.email_discovery_response=null,Context.email_discovery_timeout_occurred=!0,Context.username_state.home_realm_state=Constants.State.INVALID,EmailDiscovery.HideLookingForAccountLayout(),EmailDiscovery.PerformUIAction(Constants.EmailDiscoveryAccountState.ERROR)},ShowEmailDiscovery:function(e){if(Context.email_discovery_workflow_state!==EmailDiscovery.WorkflowStates.INIT){if(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.INIT,!Context.email_discovery_use_msa_api)return EmailDiscovery.HideEmailDiscovery(),EmailDiscovery.HandleTimeoutHomeRealmInfo(),void EmailDiscovery.ShowSplitter();var t=!1;Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.home_realm_state=Constants.State.NONE,Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",void 0===e?Support.showClientMessage(30136):(Support.showClientError(e),30146===e&&(t=!0)),Constants.IS_HOLOGRAPHIC&&$("#cred_userid_container ."+e).length>0&&Util.OnBack(),$("#forget_tile_container").hide(),$("#cred_userid_container").show(),$("#cred_userid_inputtext").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_userid_inputtext").focus(),t?($("#cred_try_again_button").show(),$("#cred_continue_button").hide()):($("#cred_continue_button").show(),$("#cred_try_again_button").hide()),$("#cred_password_container").hide(),$("#recover_container").hide(),$("#cred_kmsi_container").hide(),$("#switch_user_container").hide(),$("#alternative-identity-providers").hide()}},HideEmailDiscovery:function(){$("#cred_userid_container").hide(),$("#cred_continue_button").hide(),$("#cred_cancel_button").hide(),$("#cred_try_again_button").hide(),$("#create_msa_account_container").hide(),Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.enable_redirect=!1,Context.username_state.enable_guests=!1,User.UsernameOnChangeHandler()},BackToUserTiles:function(){EmailDiscovery.HideEmailDiscovery(),Context.email_discovery_mode=!1,EmailDiscovery.RevertUserTiles(),Tiles.drawUsers(),$("#tiles_cta_text").show(),$(".login_cred_options_container").removeClass("email_discovery"),$("#create_msa_account_container").hide(),Context.username_state.home_realm_state=Constants.State.NONE,Tiles.CancelTileRedirect()},ShowLookingForAccountLayout:function(){Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.LOOKING&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.LOOKING,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_LOOKING_FOR_ACCOUNT_TO_EMAILDISCOVERY_START),$("#looking_container").show(),$("a#looking_cancel_link").focus(),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500))},HideLookingForAccountLayout:function(){$("#looking_container").hide(),$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid)},CancelLookingForAccount:function(){Context.email_discovery_lookup_xhr.abort()},ShowSplitter:function(){if(Context.email_discovery_workflow_state!==EmailDiscovery.WorkflowStates.SPLITTER)if(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.SPLITTER,Context.email_discovery_splitter_shown=!0,EmailDiscovery.SetupTilesForSplitter(),$(".login_cta_container").show(),$("#login_user_chooser").show(),Tiles.drawUsers(),$("#disambig-container").show(),Context.back_action_stack.DoesCancelActionExist()&&$("#cred_cancel_button").show(),Context.email_discovery_use_msa_api)if($(".login_cred_options_container").css("display","block"),Context.email_discovery_timeout_occurred)Support.showClientMessage(30140);else{var e=$("input#cred_userid_inputtext").val().toLowerCase();e=$.trim(e);var t=Constants.TokenizedStringMsgs.UPN_DISAMBIGUATE_MESSAGE.replace("{0}",e);$("#upn_needs_disambiguation_text").text(t),Support.showClientMessage(30139)}else EmailDiscovery.IsTilesModeActivated()||$(".login_cred_options_container").removeClass("email_discovery"),$(".login_cred_options_container").css("display","block"),$("#create_msa_account_container").show(),Support.showClientMessage(30173)},HideSplitter:function(){$("#cred_cancel_button").hide(),$("#login_user_chooser").empty(),$(".login_user_chooser").hide(),$("#login_user_chooser").hide(),$("#disambig-container").hide(),$("#create_msa_account_container").hide(),Support.hideClientErrorMessages(),Support.hideClientMessages()},BackSplitter:function(){EmailDiscovery.HideSplitter(),EmailDiscovery.ShowEmailDiscovery()},LoginMSOAccount:function(){if(Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.MSA){Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.MSA;var e={DomainName:Constants.MSA_DOMAIN,AuthURL:Constants.MSA_AUTH_URL};EmailDiscovery.HideSplitter(),EmailDiscovery.InitRedirect(),User.ReceiveFederatedDomain(e)}},LoginAADAccount:function(){Context.email_discovery_workflow_state!=EmailDiscovery.WorkflowStates.AAD&&(Context.email_discovery_workflow_state=EmailDiscovery.WorkflowStates.AAD,EmailDiscovery.HideSplitter(),!Context.email_discovery_use_msa_api||(Context.email_discovery_timeout_occurred||null===Context.email_discovery_response)&&Context.username_state.home_realm_state==Constants.State.INVALID?(EmailDiscovery.ShowAADLoginLayout(),Context.username_state.home_realm_state=Constants.State.NONE,$("#cred_userid_inputtext").focus()):Context.username_state.home_realm_state==Constants.State.FEDERATED?(Context.email_discovery_timeout_occurred&&!Util.isMSA(Context.email_discovery_response.AAD.AuthURL)&&(Context.email_discovery_easi_user=!1),EmailDiscovery.InitRedirect(),User.ReceiveFederatedDomain(Context.email_discovery_response.AAD)):(EmailDiscovery.ShowAADLoginLayout(),User.ReceiveManagedDomain(Context.email_discovery_response.AAD),$("#cred_password_inputtext").focus()))},InitRedirect:function(){$("input#cred_userid_inputtext").hide(),$("#cred_userid_container").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$("#cred_kmsi_container").show(),Context.back_action_stack.AddAction(Context.email_discovery_splitter_shown?Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_SPLITTER:Constants.CancelAction.FROM_EMAILDISCOVERY_REDIRECT_TO_EMAILDISCOVERY_START),$("div.progress").css("visibility","visible"),$(".login_cred_options_container").removeClass("email_discovery"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500)},ShowAADLoginLayout:function(){Context.email_discovery_mode=!1,Context.back_action_stack.AddAction(Context.email_discovery_splitter_shown?Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_SPLITTER:Constants.CancelAction.FROM_EMAILDISCOVERY_AAD_LOGIN_TO_EMAILDISCOVERY_START),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container").removeClass("email_discovery"),$("#cred_userid_inputtext").show(),$("#cred_password_inputtext").show(),$("#cred_userid_container").show(),$("#cred_sign_in_button").show(),$("#cred_kmsi_container").show(),$("#recover_container").show(),$("#cred_password_container").show(),$("#login_cta_text").show(),$("#cred_cancel_button").show(),TenantBranding.setUserIdHintAndKmsi()},HideAADLoginLayout:function(){Context.email_discovery_mode=!0,TenantBranding.RemoveTenantBrandingAndApplyWorkload(),$(".login_cred_options_container").addClass("email_discovery"),$("#cred_password_inputtext").val(""),$("#cred_sign_in_button").hide(),$("#cred_kmsi_container").hide(),$("#recover_container").hide(),$("#cred_password_container").hide(),$("#login_cta_text").hide(),$("#cred_cancel_button").hide()},CancelRedirect:function(){clearTimeout(Context.redirectTid),Context.username_state.home_realm_state=Constants.State.NONE,$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid),$("#redirect_message_container").hide(),$("#cred_sign_in_button").hide(),$("#redirect_cta_text").hide(),$("#redirect_company_name_text").empty(),$("#cred_kmsi_container").hide(),$(".login_cred_options_container").addClass("email_discovery"),$("#redirect_message_container").css("opacity",0),$("#redirect_message_container").addClass("hidden"),$("#redirect_message_container").addClass("no_display"),Context.email_discovery_mode=!0},GetEnumKeyName:function(e,t){for(var n in e)if(e[n]==t)return n;return null}};var EmailDiscovery=MSLogin.EmailDiscovery;$(document).ready(function(){EmailDiscovery.Initialize()});var origHide=jQuery.fn.hide;jQuery.fn.hide=function(e,t){if(e){var n=this;origHide.apply(this,[e,function(){n.each(function(e,t){t.setAttribute("aria-hidden","true")}),t&&t.call(n)}])}else origHide.apply(this,arguments),this.each(function(e,t){t.setAttribute("aria-hidden","true")});return this};var origShow=jQuery.fn.show;jQuery.fn.show=function(e,t){if(e){var n=this;origShow.apply(this,[e,function(){n.each(function(e,t){t.removeAttribute("aria-hidden")}),t&&t.call(n)}])}else origShow.apply(this,arguments),this.each(function(e,t){t.removeAttribute("aria-hidden")});return this};var origAddClass=jQuery.fn.addClass;jQuery.fn.addClass=function(e){return("no_display"===e||"hidden"===e)&&this.each(function(e,t){t.setAttribute("aria-hidden","true")}),origAddClass.apply(this,arguments),this};var origRemoveClass=jQuery.fn.removeClass;jQuery.fn.removeClass=function(e){return("no_display"===e||"hidden"===e)&&this.each(function(e,t){t.removeAttribute("aria-hidden")}),origRemoveClass.apply(this,arguments),this},MSLogin.Support={clientErrorStrings:{},is_placeholder_supported:function(){if($.browser.msie){var e=document.documentMode;if(12>e)return!1}if(navigator.userAgent.indexOf("rv:11.0")>=0)return!1;var t=document.createElement("input");return"placeholder"in t},is_prefetch_supported:function(){return navigator.userAgent.match(/iPad/)?!1:!0},showClientError:function(e){var t=!1,n=[];if(0==e)$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),$("#cta_client_error_text").hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display"),Constants.IS_HOLOGRAPHIC&&($(".footer_inner_container").show(),$("#cred_user_error_messages div.client_error_msg").hide());else{if(Constants.IS_CXH_REQUEST&&MSLogin.Util.LogCxhTelemetry("AADLoginPageClientError",e),$(".client_error_msg").each(function(){$(this).hide(),$("#"+$(this).data("elementid")).removeClass("inputState_error")}),$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),Constants.IS_HOLOGRAPHIC&&$(".footer_inner_container").hide(),$("#cta_client_error_text").show(),arguments.length>1){n=new Array(arguments.length-1);for(var o=0;o<n.length;o++)n[o]=arguments[o+1]}$(".client_error_msg."+e).each(function(){n.length>=1&&(Support.clientErrorStrings[e]||(Support.clientErrorStrings[e]=$(this).html()),$(this).html(Support.clientErrorStrings[e].format(n))),$(this).show();var o=$("#"+$(this).data("elementid"));o.addClass("inputState_error"),o.length>0&&(o[o.length-1].focus(),t=!0)})}return t},hideClientError:function(e){$(".client_error_msg."+e).hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display")},hideClientErrorMessages:function(){$("#cta_error_message_text").hide(),$("#login_cta_text").hide(),$("#cta_client_error_text").hide(),$(".client_error_msg").hide(),$("#cta_error_message_text").hide(),$("#login_cta_text").show(),$("#create_msa_account_container").removeClass("no-display")},showClientMessage:function(e){$(".cta_message_text").hide(),$("#cta_client_message_text").show(),$(".cta_message_text."+e).show()},hideClientMessages:function(){$(".cta_message_text").hide(),$("#cta_client_message_text").hide()},showUsernameOrDomainError:function(e){var t;if(Constants.IS_MSA_FED_SUPPORTED){$("#user-not-found-link-ebd, #user-not-found-link").off("click"),t=Support.showClientError(30065,e);var n=User.GetRedirectAction(Constants.msaSignupUrl,Constants.msaSignupUrl,Constants.msaRedirSignupErrorParams,e);$("#user-not-found-link-ebd, #user-not-found-link").click(function(e){e.preventDefault(),n()})}else t=Support.showClientError(30068,e.substring(e.lastIndexOf("@")+1));return t},validateUsernameCredInput:function(e){var t=MSLogin.Constants;return Constants.IS_MSA_PHONE_USERNAME_SUPPORTED&&t&&t.REGEX_EMAIL&&t.REGEX_PHONE?t.REGEX_EMAIL.test(e)||t.REGEX_PHONE.test(e):t.REGEX_EMAIL.test(e)},validateCredInputs:function(e){var t=Support.validateUsernameInput();0!==t||void 0!=e&&!e||(t=Support.validatePassword());var n=!1;return Constants.IS_HOLOGRAPHIC||(n=Support.showClientError(t)),t?(Constants.IS_HOLOGRAPHIC||n||(void 0!=$("input#cred_userid_inputtext").css("display")&&"none"!=$("input#cred_userid_inputtext").css("display")&&""!=$("input#cred_password_inputtext").val()?$("input#cred_userid_inputtext").focus():$("input#cred_password_inputtext").focus()),!1):!0},validatePassword:function(){var e=$("input#cred_password_inputtext").val(),t=0;return""==e&&(t=30111,Constants.IS_HOLOGRAPHIC||$("input#cred_password_inputtext").focus()),Constants.IS_HOLOGRAPHIC&&Support.showClientError(t),t},validateUsernameInput:function(){var e=$("input#cred_userid_inputtext").val(),t=30067;return e=e.toLowerCase(),""==e?t=30127:Constants.IS_NAME_COEXISTENCE_ACCOUNT||Support.validateUsernameCredInput(e)?t=0:(t=30064,null!=e&&-1!=e.indexOf("\\")&&(t=30066)),Constants.IS_HOLOGRAPHIC&&Support.showClientError(t),t},forceCredBlockHeight:function(){},renderBrowserSpecificForNarrowWidth:function(e){User.resize_bg(),Background.winW<Constants.MOBILE_WIDTH_THRESHOLD&&($.browser.msie&&e>=8&&$(".push").css("height","2em"),$.browser.msie&&6>=e&&$(".login_panel").css("padding-left","50px"))},renderBrowserSpecificForNarrowHeight:function(){if(User.resize_bg(),Background.winH<Constants.MOBILE_HEIGHT_THRESHOLD||"1"==Util.ExtractQSParam("popupui")){var e=!0;navigator.userAgent.match(/IEMobile/)&&(e=!1),navigator.userAgent.match(/Android/)&&(e=!1),navigator.userAgent.match(/iPhone/)&&(e=!1),navigator.userAgent.match(/iPad/)&&(e=!1),e?$("#footer_links_container").addClass("sticky_footer"):$("#footer_links_container").removeClass("sticky_footer")}},renderBrowserSpecific:function(){var e=document.documentMode;if($.browser.msie&&e>=8&&($(".push").css("display","inline-block"),$(".push").css("height","6em")),(navigator.userAgent.match(/iPad/)||navigator.userAgent.match(/iPhone/))&&(Support.forceCredBlockHeight(),$(".cred").css("margin-bottom","-3em"),$(".login_guest_container").css("margin-bottom","0px")),$.browser.msie&&e>8&&$(".show_other").css("margin-left","-5px"),$.browser.msie&&7>=e&&($(".ie_legacy").css("display","none"),$("body").css("background-color",$("html").css("background-color")),$("a.tile_link").css("margin-left","0px"),$("table.user_tile").css("margin-left","0px"),$("table.user_tile").css("margin-bottom","10px"),$(".show_other").css("margin-left","0px")),$.browser.msie&&6>=e&&$("body").css("overflow-y","hidden"),$.browser.mozilla&&$(".input_border").addClass("high_contrast_border"),navigator.userAgent.match(/IEMobile/),navigator.userAgent.match(/Android 2\.3/)&&("optin.2.0"!=$("meta[name=PageID]").attr("content")&&$("body").css("font-size","0.5em"),$(".login_footer_container").css("margin-top","-12em"),$(".login_guest_container").css("padding-top","0px"),$(".cred").css("padding-bottom","10em"),Support.forceCredBlockHeight()),navigator.userAgent.match(/Android/)&&$("body").css("height","100vh"),$.browser.msie&&10==e){$(".cred").css("padding-bottom","100px");var t=$(window).height()-$(".login_footer_container").height()+30;$("#login_panel_center").css("height",t+"px"),document.body.onresize=function(){var e=$(window).height()-$(".login_footer_container").height()+30;$("#login_panel_center").css("height",e+"px")}}if($.browser.webkit&&$("form :input").blur(function(){User.resize_bg()}),Support.renderBrowserSpecificForNarrowWidth(e),Support.renderBrowserSpecificForNarrowHeight(e),$.browser.msie&&document.documentMode<11){$(".cred").css("padding-bottom","0px");var n=function(){var e=$(window).height()-$("#true_inner").height()-$(".push").height()-60;$("#login_panel_center").css("height",e>0?$(window).height()-15:"")};document.body.onresize=n,n()}},getViewport:function(){var e,t;return"undefined"!=typeof window.innerWidth?(e=window.innerWidth,t=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth&&0!=document.documentElement.clientWidth?(e=document.documentElement.clientWidth,t=document.documentElement.clientHeight):(e=document.getElementsByTagName("body")[0].clientWidth,t=document.getElementsByTagName("body")[0].clientHeight),[e,t]},showIllustration:function(){var e=Support.getViewport(),t=!0;return Background.winW<Constants.MOBILE_WIDTH_THRESHOLD?t=!1:e[0]<Constants.MOBILE_WIDTH_THRESHOLD?t=!1:navigator.userAgent.match(/IEMobile/)?t=!1:navigator.userAgent.match(/Android 2\.3/)?t=!1:"1"==Util.ExtractQSParam("popupui")&&(t=!1),t},showTileTooltips:function(){var e=!0;return navigator.userAgent.match(/iPad/)?e=!1:navigator.userAgent.match(/iPhone/)&&(e=!1),e},isDefined:function(e){return null!=e&&void 0!=e&&(e.length>0||"object"==typeof e||"boolean"==typeof e||"number"==typeof e)},getDomain:function(e){var t=$.trim(e),n=function(e){return-1!=e.indexOf("@")&&e.indexOf("@")<e.length},o=function(e){return Support.isDefined(e)&&n(e)};if(o(t)){var i=e.substring(t.indexOf("@")+1);if(i.length>0)return i}return null},checkIfDomainsMatch:function(e,t){var n=Support.getDomain(e),o=Support.getDomain(t);return null!=n&&null!=o?n.toLowerCase()==o.toLowerCase():!1},GetOriginalPasswordResetLinkUrl:function(){var e=Context.password_reset_link_url;if(!Support.isDefined(e)){var t=$("a#cred_forgot_password_link");Support.isDefined(t)&&Support.isDefined(t.attr("href"))&&(e=t.attr("href")),Support.isDefined(e)?Context.password_reset_link_url=e:e=null}return e},UpdatePasswordResetLink:function(){var e=$("a#cred_forgot_password_link"),t=Support.GetOriginalPasswordResetLinkUrl();if(Support.isDefined(e)&&Support.isDefined(t)){var n=decodeURIComponent(Util.ExtractQSParam("whr")),o=$("input#cred_userid_inputtext").val();-1==t.indexOf("?")&&(t+="?"),Support.isDefined(n)&&(t+="&whr="+encodeURIComponent(n)),Support.isDefined(o)&&(t+="&username="+encodeURIComponent(o)),e.attr("href",t)}},IsBrowserVersionGreaterOrEqual:function(e,t){if("*"==t)return!0;if(!Support.isDefined(e)||!Support.isDefined(t))return!1;for(var n=e.split("."),o=t.split("."),i=!1,a=0;a<o.length;a++){var r=parseInt(n[a],10),s=parseInt(o[a],10);if(isNaN(r)||isNaN(s))return!1;if(s>r)return!1;if(r>s)return!0;i=!0}return i},ViewErrorDetails:function(){$(".view-error-details-title").toggleClass("no_display"),$(".view-error-details-content").toggleClass("no_display")},IForgotMyPassword:function(){$(".i-forgot-my-password-content").toggleClass("no_display")},LegalActionLink:function(e){$.ajax({url:e,data:{IsAjax:!0},success:function(e){$(".login_panel_layout").hide(),$(".legal_container").html(e).show(),$("#legal-back-button").click(function(){$(".legal_container").hide(),$(".login_panel_layout").show()})},error:function(){}})}};var Support=MSLogin.Support;jQuery.support.placeholder=function(){return Support.is_placeholder_supported()}(),jQuery.support.cookies=function(){return document.cookie="testcookie=testcookie",-1!=document.cookie.indexOf("testcookie=testcookie")?!0:!1}();var MSLogout={logoutstate:null,success:[],error:[],noOfIncompleteSites:0,thirdPartyCookieEnabled:-1,showSignOutInfo:function(){MSLogout.checkThirdPartyCookies(),$.each(MSLogout.logoutstate.sites,function(e,t){MSLogout.checkSiteCookies(t)})},checkThirdPartyCookies:function(){void 0!==MSLogout.logoutstate.thirdPartyCookieURL&&$("<img/>").attr("src",MSLogout.logoutstate.thirdPartyCookieURL).load(function(){MSLogout.thirdPartyCookieEnabled=ThirdPartyCookieStates.ENABLED}).error(function(){MSLogout.thirdPartyCookieEnabled=ThirdPartyCookieStates.DISABLED}()).addClass("hidden")},checkSiteCookies:function(e){var t=e;MSLogout.noOfIncompleteSites++;var n=$("<img/>").attr("src",t.url).load(function(){var e=t;return function(){MSLogout.noOfIncompleteSites--,MSLogout.success.push(e)}}()).error(function(){var e=t;return function(){MSLogout.noOfIncompleteSites--,MSLogout.error.push(e)}}()).addClass("hidden");$("body").append(n)},displaySiteList:function(){if(MSLogout.thirdPartyCookieEnabled!=ThirdPartyCookieStates.NOT_LOADED&&0==MSLogout.noOfIncompleteSites){$(".signed_out_sites").show(),$("#more_info_text").hide();var e="#success_signed_out_sites";MSLogout.thirdPartyCookieEnabled==ThirdPartyCookieStates.DISABLED&&(e="#error_signed_out_sites"),$.each(MSLogout.success,function(t,n){$(e).append($("<div/>").attr("id","site_"+n.id).text(n.name+" ("+n.id+")"))}),$.each(MSLogout.error,function(e,t){$("#error_signed_out_sites").append($("<div/>").attr("id","site_"+t.id).text(t.name+" ("+t.id+")"))}),MSLogout.displaySAMLList()}},displaySAMLList:function(){var e,t=MSLogout.logoutstate.samlNamespace;if(void 0!=t){e=t.status?"#success_signed_out_sites":"#error_signed_out_sites";var n=$("<div/>").html(t.name).text();$(e).append($("<div/>").attr("id","site_saml").text(n+" ("+t.domain+")"))}}};MSLogout.ThirdPartyCookieStates={NOT_LOADED:-1,DISABLED:0,ENABLED:1};var ThirdPartyCookieStates=MSLogout.ThirdPartyCookieStates,PostType={INVALID:"0",PASSWORD:"11",FEDERATION:"13",SHA1_PASSWORD:"15",SHA1HASH_PASSWORD:"16"},LoginOption={EMPTY:"0",REMEMBER_PASSWORD:"1",REMEMBER_USER_TILE:"2",NOTHING_CHECKED:"3",OTHER_SAVED_USERS:"4",ACTIVE_USER:"5"};MSLogin.Post={isSubmitting:!1,DetermineBrowser:function(){return $.browser.msie?"MSIE":$.browser.chrome?"Chrome":$.browser.webkit?"Webkit":$.browser.safari?"Safari":$.browser.mozilla?"Firefox":$.browser.opera?"Opera":"Unknown"},IsSubmitReady:function(e){switch(Context.username_state.home_realm_state){case Constants.State.FEDERATED:return!1;case Constants.State.MANAGED:break;case Constants.State.INVALID:break;case Constants.State.NONE:if(User.UpdateUsernameState(),!Context.username_state.is_empty&&!Context.username_state.is_partial&&!Constants.IS_NAME_COEXISTENCE_ACCOUNT)return User.RefreshDomainState(),!1;break;default:return!1}return Support.validateCredInputs(e)?Post.isSubmitting?!1:(Post.isSubmitting=!0,!0):!1},GetCredParameters:function(e){var t=[];if(e)try{var n=new Date,o=n.getTime()-n.getMilliseconds()-12e4,i=window.performance.timing;t.push({name:"n1",value:i.navigationStart-o}),t.push({name:"n2",value:i.redirectStart-o}),t.push({name:"n3",value:i.redirectEnd-o}),t.push({name:"n4",value:i.fetchStart-o}),t.push({name:"n5",value:i.domainLookupStart-o}),t.push({name:"n6",value:i.domainLookupEnd-o}),t.push({name:"n7",value:i.connectStart-o}),t.push({name:"n8",value:i.secureConnectionStart-o}),t.push({name:"n9",value:i.connectEnd-o}),t.push({name:"n10",value:i.requestStart-o}),t.push({name:"n11",value:i.responseStart-o}),t.push({name:"n12",value:i.responseEnd-o}),t.push({name:"n13",value:i.domLoading-o}),t.push({name:"n14",value:i.domInteractive-o}),t.push({name:"n15",value:i.domContentLoadedEventEnd-i.domContentLoadedEventStart}),t.push({name:"n16",value:i.domComplete-o}),t.push({name:"n17",value:i.loadEventStart-o}),t.push({name:"n18",value:i.loadEventEnd-o}),t.push({name:"n19",value:Instrument.home_realm_load_time}),t.push({name:"n20",value:Instrument.latency_sensitivity}),t.push({name:"n21",value:Instrument.prefetch_done?1:0}),t.push({name:"n22",value:Instrument.prefetch_load_time}),t.push({name:"n23",value:Instrument.background_image_loaded?1:0}),t.push({name:"n24",value:Instrument.background_image_load_time}),t.push({name:"n25",value:null!==Tiles.users?Tiles.users.length-1:0}),t.push({name:"n26",value:Instrument.email_discovery_ui_code}),t.push({name:"n27",value:Instrument.email_discovery_splitter_choice}),t.push({name:"n28",value:Instrument.possible_easi_user}),t.push({name:"n29",value:Instrument.tenant_branding_process_end_time-Instrument.tenant_branding_start_time}),t.push({name:"n30",value:Instrument.tenant_branding_json_end_time-Instrument.tenant_branding_start_time}),t.push({name:"n31",value:Instrument.tenant_branding_load_error?1:0}),t.push({name:"n32",value:Instrument.has_tenant_branding?1:0}),t.push({name:"n33",value:Instrument.has_dynamic_tenant_branding?1:0}),t.push({name:"n34",value:Instrument.logo_image_load_time}),t.push({name:"n35",value:Instrument.background_image_error?1:0}),t.push({name:"n36",value:Instrument.logo_image_error?1:0}),t.push({name:"n37",value:Instrument.tenant_branding_total_time}),t.push({name:"n38",value:Instrument.tenant_branding_number_of_switches}),t.push({name:"n39",value:Instrument.tenant_branding_right_side_time}),t.push({name:"n40",value:Instrument.logo_image_end_time}),t.push({name:"n41",value:Instrument.background_image_end_time}),t.push({name:"n42",value:Instrument.document_ready_end_time}),t.push({name:"n43",value:Instrument.document_load_end_time})}catch(a){}t.push({name:"type",value:PostType.PASSWORD}),t.push($("#cred_keep_me_signed_in_checkbox").attr("checked")?{name:"LoginOptions",value:LoginOption.REMEMBER_PASSWORD}:EmailDiscovery.IsDiscoveryPage()||Context.post_from_tile?{name:"LoginOptions",value:LoginOption.REMEMBER_USER_TILE}:{name:"LoginOptions",value:LoginOption.NOTHING_CHECKED}),t.push({name:"NewUser",value:1}),t.push({name:"idsbho",value:1}),t.push({name:"PwdPad",value:""}),t.push({name:"sso",value:""});
var r=decodeURIComponent(Util.ExtractQSParam("vv"));return t.push({name:"vv",value:r}),t.push({name:"uiver",value:1}),t.push({name:"i12",value:"https:"==window.location.protocol?1:0}),t.push({name:"i13",value:Post.DetermineBrowser()}),t.push({name:"i14",value:$.browser.version}),t.push({name:"i15",value:Background.winW}),t.push({name:"i16",value:Background.winH}),t.push(Constants.IS_CXH_REQUEST?{name:"i20",value:Constants.IS_CXH_REQUEST}:{name:"i20",value:""}),Context.redirect_to_manage&&$.each(t,function(e,t){"LoginOptions"==t.name&&(t.value="1"+t.value)}),t},submitCredsWorker:function(e){if(Post.IsSubmitReady(e)){$("#cred_password_inputtext").focus();var t=[];if(t=Post.GetCredParameters(Constants.SUBMIT_METRICS_ON_POST),Constants.IS_CXH_REQUEST&&Constants.CxhFlow&&Constants.CxhFlow.toUpperCase().startsWith("FRX")&&e&&"undefined"!=typeof CloudExperienceHost&&"undefined"!=typeof CloudExperienceHost.Bridge)try{var n=new CloudExperienceHost.Bridge;n.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-username",$("input#cred_userid_inputtext").val()),Constants.EncryptOOBEPassword?n.invoke("CloudExperienceHost.MSA.encryptUserData",$("input#cred_password_inputtext").val()).done(function(e){n.invoke("CloudExperienceHost.Storage.PrivateData.addItem","oobe-password",e)},function(){n.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-password",$("input#cred_password_inputtext").val())}):n.invoke("CloudExperienceHost.Storage.SharableData.addValue","oobe-password",$("input#cred_password_inputtext").val()),t.push({name:"i21",value:""})}catch(o){t.push({name:"i21",value:o.message})}var i=[];$.each(t,function(e,t){-1===$.inArray(t.name,i)&&void 0!==t.value&&($("<input />").attr("type","hidden").attr("name",t.name).attr("value",t.value).appendTo("#credentials"),i.push(t.name))}),$("form#credentials").submit()}},SubmitCreds:function(){Post.submitCredsWorker(!0)},SubmitUsername:function(){Post.submitCredsWorker(!1)},SubmitInstrumentation:function(){var e=[];e=Post.GetCredParameters(Constants.SUBMIT_METRICS_ON_REDIRECT),e.login="federated",e.passwd="",e.LoginOptions=LoginOption.NOTHING_CHECKED;var t={};$.each(e,function(e,n){void 0!==n.value&&(t[n.name]=n.value)}),$.ajax({headers:{Accept:"application/json"},url:$("#credentials").attr("action")+"&clientMetrics&federatedDomain="+Context.federated_domain,type:"POST",dataType:"json",data:t,async:!0,timeout:200})}};var Post=MSLogin.Post;/**
 * @preserve Copyright 2016 (C) Microsoft Corporation. All rights reserved.
 */
!function(){function e(){function e(){$("#redirect_dots_animation").show(),$("#redirect_dots_animation").css("visibility","visible"),User.setupCredFieldsWithPlaceHolder(),setTimeout(User.startAnimation,0),A=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),x=!0,l(Constants.StrongAuth.Context)}function i(e){D=e,O=e.AuthMethodId,x=!0,0===e.AuthMethodId.toUpperCase().indexOf("TWOWAYVOICE")?($(".tfa_results_text.30050").show(),$("#tfa_button_container").hide(),$("button#tfa_signin_button").prop("disabled",!0)):0===e.AuthMethodId.toUpperCase().indexOf("TWOWAYSMS")?($(".tfa_results_text.30049").show(),Constants.IS_HOLOGRAPHIC&&$("button#tfa_signin_button").prop("disabled",!0)):0===e.AuthMethodId.toUpperCase().indexOf("PHONEAPPNOTIFICATION")&&$(".tfa_results_text.30051").show(),"none"!=e.MethodDisplayString?($("#tfa_phone_text").text(e.MethodDisplayString),$("#tfa_phone_text").show(),$(".tile_secondary_name").show(),$(".tile_secondary_name").text(e.MethodDisplayString)):($("#tfa_phone_text").hide(),$(".tile_secondary_name").hide()),$("#tfa_options_link_container").show();var t={Method:"BeginAuth",flowToken:Constants.StrongAuth.FlowToken,ctx:Constants.StrongAuth.Ctx,AuthMethodId:e.AuthMethodId};C(),a(Object.toJSON(t))}function a(e){R=$.ajax({headers:{Accept:"application/json"},url:Constants.StrongAuth.SASControllerBeginAuthUrl,timeout:Constants.TWOFA_TIMEOUT,data:e,dataType:"json",type:"POST",contentType:"application/json",success:u,error:c})}function r(e){var t={Method:"EndAuth",SessionId:e.SessionId,FlowToken:e.FlowToken,Ctx:e.Ctx,AuthMethodId:e.AuthMethodId};b&&(w++,Constants.TWOFA_MAX_POLLS>=w?s(Object.toJSON(t)):_(e))}function s(e){I=setTimeout(function(){R=$.ajax({headers:{Accept:"application/json"},url:Constants.StrongAuth.SASControllerEndAuthUrl,timeout:Constants.TWOFA_TIMEOUT,data:e,dataType:"json",type:"POST",contentType:"application/json",success:g,error:c})},Constants.TWOFA_POLLING_INTERVAL)}function d(e){if(x){$("#cred_remember_mfa_container").hide();var t="30062";switch(e.ResultValue){case"UserVoiceAuthFailedCallWentToVoicemail":t="30106";break;case"UserVoiceAuthFailedInvalidPhoneInput":case"UserVoiceAuthFailedPhoneHungUp":t="30107";break;case"UserVoiceAuthFailedInvalidPhoneNumber":case"UserVoiceAuthFailedInvalidExtension":case"InvalidFormat":t="30109";break;case"UserAuthFailedDuplicateRequest":case"UserVoiceAuthFailedPhoneUnreachable":case"UserVoiceAuthFailedProviderCouldntSendCall":t="30108";break;case"User2WaySMSAuthFailedProviderCouldntSendSMS":case"SMSAuthFailedProviderCouldntSendSMS":t="30434";break;case"User2WaySMSAuthFailedNoResponseTimeout":t="30435";break;case"SMSAuthFailedNoResponseTimeout":case"SMSAuthFailedWrongCodeEntered":case"OathCodeIncorrect":case"OathCodeDuplicate":case"OathCodeOld":t="30436";break;case"PhoneAppNoResponse":t="30437";break;case"User2WaySMSAuthFailedWrongCodeEntered":t="30438";break;case"PhoneAppInvalidResult":t="30439";break;case"PhoneAppDenied":t="30440";break;case"PhoneAppTokenChanged":t="30441"}null===D?$(".tfa_results_text").hide():0===D.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0===D.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),$(".tfa_error_text."+t).show(),h(e),clearInterval(A)}}function _(e){x&&(null===D?$(".tfa_results_text").hide():0===D.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0===D.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),$(".tfa_error_text.30442").show(),h(e),clearInterval(A),k=!1)}function c(e,t){if(x){if(null===D?$(".tfa_results_text").hide():0===D.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")?$(".tfa_results_text.30167").show():0===D.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")?$(".tfa_results_text.30166").show():$(".tfa_results_text").hide(),$("#redirect_dots_animation").hide(),"timeout"==t?$(".tfa_error_text.30442").show():$(".tfa_error_text.30062").show(),clearInterval(A),k=!1,D&&D.SessionId){var n=v.errTemplate.format(D.SessionId?Util.htmlEncode(D.SessionId):"",D.CorrelationId?Util.htmlEncode(D.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(n).show()}C()}}function l(e){if("true"==e.Result){if(U=e,null===e.DefaultMethod)return void $(".tfa_error_text.30126").show();i(e.DefaultMethod)}}function u(e){if("true"==e.Result){y=e.FlowToken,L=e.Ctx,D.SessionId=e.SessionId,D.CorrelationId=e.CorrelationId;var t,n=!1;if(0===e.AuthMethodId.toUpperCase().indexOf("ONEWAYSMS")&&O&&0===O.toUpperCase().indexOf("ONEWAYSMS")?(t="30167",n=!0):0===e.AuthMethodId.toUpperCase().indexOf("PHONEAPPOTP")&&O&&0===O.toUpperCase().indexOf("PHONEAPPOTP")&&(t="30166",n=!0),n)clearInterval(A),Constants.IS_HOLOGRAPHIC&&("options"!==Util.HoloNavigationStack[Util.HoloNavigationStack.length-1].name&&Util.HoloNavigationStack.push({name:"options",show:E}),Util.HoloNavigationStack.push({name:"verifyCode",show:null})),$("#tfa_signin_button").show(),$("button#tfa_signin_button").prop("disabled",!1),$("input#tfa_code_inputtext").val(""),$("#redirect_dots_animation").hide(),$(".tfa_results_text").hide(),$(".tfa_results_text."+t).show(),$("#tfa_code_container").show(),$("#tfa_pin_container").length&&($("input#tfa_pin_inputtext").val(""),$("#tfa_pin_container").show(),$("input#tfa_pin_inputtext").keypress(function(e){User.KeyPressEnter(e,v.submitCode,13)})),$("#tfa_code_inputtext").focus(),$("#tfa_button_container").show(),$("input#tfa_code_inputtext").keypress(function(e){User.KeyPressEnter(e,v.submitCode,13)}),$("#tfa_signin_button").keypress(function(e){User.KeyPressEnter(e,v.submitCode,13)}),setTimeout(function(){var t=e.SessionId;if(D.SessionId===t&&x&&0===$("input#tfa_code_inputtext").val().length){$(".tfa_error_text.30442").show();var n=v.errTemplate.format(D.SessionId?Util.htmlEncode(D.SessionId):"",D.CorrelationId?Util.htmlEncode(D.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(n).show(),C()}},Constants.TWOFA_AUTH_TIMEOUT),C();else{var o={Method:"EndAuth",SessionId:e.SessionId,FlowToken:e.FlowToken,Ctx:e.Ctx,AuthMethodId:e.AuthMethodId};w=0,C(),s(Object.toJSON(o))}}else d(e)}function g(e){return D.SessionId!=e.SessionId?(d(e),void(k=!1)):void("true"==e.Result?m(e):"true"==e.Retry?r(e):(d(e),k=!1))}function m(e){if(b){var t=n.createElement("form");t.setAttribute("method","post"),t.setAttribute("action",Constants.StrongAuth.SASControllerProcessAuthUrl);var i=n.createElement("input");i.setAttribute("type","hidden"),i.setAttribute("name","request"),i.setAttribute("value",e.Ctx),t.appendChild(i);var a=n.createElement("input");if(a.setAttribute("type","hidden"),a.setAttribute("name","flowToken"),a.setAttribute("value",e.FlowToken),t.appendChild(a),o&&o.canary){var r=n.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name","canary"),r.setAttribute("value",o.canary),t.appendChild(r)}var s=n.createElement("input");s.setAttribute("type","hidden"),s.setAttribute("name","mfaAuthMethod"),s.setAttribute("value",e.AuthMethodId),t.appendChild(s);var d=$("#cred_remember_mfa_checkbox").attr("checked")?!0:!1,_=n.createElement("input");_.setAttribute("type","hidden"),_.setAttribute("name","rememberMFA"),_.setAttribute("value",d),t.appendChild(_),n.body.appendChild(t),t.submit()}}function p(e,t){if(e.length!==Constants.TWOFA_OTP_MAX_LEN||Math.ceil(e)!==Math.floor(e)||$("#tfa_pin_container").length&&(0===t.length||Math.ceil(t)!==Math.floor(t))){$("#tfa_client_side_error_text").show();var n=v.errTemplate.format(D.SessionId?Util.htmlEncode(D.SessionId):"",D.CorrelationId?Util.htmlEncode(D.CorrelationId):"",(new Date).toISOString());return $("#tfa_error_text").html(n).show(),C(),!1}return!0}function h(e){var t=v.errTemplateWithErrorCode.format(0|e.ErrCode,e.SessionId?Util.htmlEncode(e.SessionId):"",e.CorrelationId?Util.htmlEncode(e.CorrelationId):"",(new Date).toISOString());$("#tfa_error_text").html(t).show(),C()}function C(){var e=$("#tfa_outer_list_container").height();$(".cred").css("min-height",e)}function S(){setTimeout(User.startAnimation,0),A=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),e()}function E(){if(R&&R.abort(),clearInterval(I),clearInterval(A),b=!1,x=!1,O="",$("#tfa_remember_my_device_container").hide(),$("#redirect_dots_animation").hide(),$(".tfa_results_text").hide(),$("#tfa_phone_text").hide(),$("#tfa_title_text").hide(),$(".tfa_error_text").hide(),$("#tfa_options_link_container").hide(),$("#tfa_code_container").hide(),$("#tfa_pin_container").hide(),$("#tfa_button_container").hide(),$("#header_text").text(Constants.TWOFA_HEADER_TEXT_SELECTMETHOD),$("#tfa_client_side_error_text").hide(),$("#tfa_options_title_text").show(),Constants.IS_HOLOGRAPHIC){$("#tfa_back_button").addClass("no_display").parent().addClass("buttonGroup_fullWidth"),Util.HoloNavigationStack.push({name:"options",show:E});var e=$("#tfa_options_list").empty();$.each(U.Methods,function(t,n){n.AuthMethodDeviceId&&t<Constants.TWOFA_MAXMETHODS&&e.append($("<option></option>").text(n.MethodDisplayString).val(t))}),e.parent().removeClass("no_display")}else $("#tfa_options_list").show(),$("button#tfa_signin_button").prop("disabled",!0),$.each(U.Methods,function(e,t){if(t.AuthMethodDeviceId&&e<Constants.TWOFA_MAXMETHODS){var n=$("#link"+e);n.text(t.MethodDisplayString),n.attr("href","#"),n.off("click").on("click",function(){v.beginAltAuth(e)}),$("#listItem"+e).show();var o=$("#link_icon"+e).removeClass("voice sms device");o.addClass(t.AuthMethodId&&-1!==t.AuthMethodId.indexOf("Voice")?"voice":t.AuthMethodId&&-1!==t.AuthMethodId.indexOf("SMS")?"sms":"device")}})}function f(){$("#compromised_landing_container").hide(),$("#compromised_landing_action").hide(),Constants.StrongAuth&&S(),$("#tfa_signin_button").show(),$("#tfa_outer_list_container").show()}function T(){var e=$("#fmProofup").attr("action"),t=-1==e.indexOf("?")?"?":"&";$("#login_workload_logo_image").length>0&&($("#login_workload_logo_image").attr("src").toLowerCase().indexOf("office365")>=0?$("#fmProofup").attr("action",e+t+"BrandContextID=O365"):$("#login_workload_logo_image").attr("src").toLowerCase().indexOf("/azure/logo.png")>=0&&$("#fmProofup").attr("action",e+t+"BrandContextID=Azure")),n.fmProofup.submit()}var v=this,A=0,I=0,w=0,b=!0,x=!1,k=!1,D=null,O="",U=null,R=null,y=null,L=null;v.beginAltAuth=function(e){$("#redirect_dots_animation").show(),$("#tfa_phone_text").show(),$("#tfa_title_text").show(),$(".tfa_error_text").show(),$("#tfa_options_link_container").show(),$(".tfa_error_text").hide(),$("#tfa_options_title_text").hide(),$("#tfa_remember_my_device_container").show(),$("#header_text").text(Constants.TWOFA_HEADER_TEXT_PROTECTACCOUNT),Constants.IS_HOLOGRAPHIC?($("#tfa_options_list").parent().addClass("no_display"),$("#tfa_back_button").removeClass("no_display").parent().removeClass("buttonGroup_fullWidth")):$("#tfa_options_list").hide(),b=!0,k=!1,User.startAnimation(),A=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),i(U.Methods[e])},v.submitCode=function(){if($(".tfa_error_text").hide(),!k){var e=$("input#tfa_code_inputtext").val();e=$.trim(e);var t="";if($("#tfa_pin_container").length&&(t=$("input#tfa_pin_inputtext").val(),t=$.trim(t)),p(e,t)){e+=t,k=!0,$("#tfa_client_side_error_text").hide();var n={Method:"EndAuth",FlowToken:y,SessionId:D.SessionId,Ctx:L,AuthMethodId:D.AuthMethodId,AdditionalAuthData:e};w=0,$("#redirect_dots_animation").show(),setTimeout(User.startAnimation,0),A=setInterval(User.startAnimation,Constants.TWOFA_ANIMATION_INTERVAL),s(Object.toJSON(n))}}},v.init=function(){var e=$("meta[name=PageID]").attr("content"),n="strongauthcheck.2.0"===e,o="proofup.2.0"===e;if(n||o){if($("#switch_user_link").length){var i=$("#switch_user_link").attr("href"),a=/^\d+$/,r=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;i=Util.AddQSParamIfNotExists(i,"id",a),i=Util.AddQSParamIfNotExists(i,"lc",a),i=Util.AddQSParamIfNotExists(i,"username",r),i=Util.AddQSParamIfNotExists(i,"ru"),i=Util.AddQSParamIfNotExists(i,"whr"),i=Util.AddQSParamIfNotExists(i,"wreply"),i=Util.AddQSParamIfNotExists(i,"wauth"),$("#switch_user_link").attr("href",i)}$("#show-options").on("click",function(e){e.preventDefault(),E()}),$("#compromised_landing_action").on("click",function(e){e.preventDefault(),f()}),Constants.IS_CXH_REQUEST&&o?($("#tfa_signin_button").text(t.GetString("Mfa.SetItUpNow")),$("button#tfa_signin_button").prop("disabled",!1),$("#tfa_signin_button").on("click",T)):(Constants.IS_HOLOGRAPHIC?($("#tfa_back_button").on("click",Util.OnBack),$("#tfa_signin_button").on("click",Util.OnNext),Util.HoloNavigationStack.push({name:"finalBack",show:Util.CancelCxhFlow})):($("#tfa_setupnow_button").on("click",T),$("#tfa_signin_button").on("click",v.submitCode)),n&&($("#redirect_dots_animation").show(),$("#redirect_dots_animation").css("visibility","visible"),User.setupCredFieldsWithPlaceHolder(),Constants.HAS_LANDING_PAGE||S()))}}}var t=window,n=t.document,o=t.$Config;t.StrongAuthCheck=new e,$(t).load(t.StrongAuthCheck.init)}(),MSLogin.TenantBranding={IsDynamicBrandingEnabled:function(){return $.browser.chrome&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"42")||$.browser.webkit&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"537.4")||$.browser.mozilla&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"5.0")||$.browser.msie&&Support.IsBrowserVersionGreaterOrEqual($.browser.version,"8.0")||$.browser.msie&&window.navigator&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("Trident")>0?!0:!1},IsShowingDynamicBranding:function(){return TenantBranding.IsDynamicBrandingEnabled()&&Context.TenantBranding.enabled},IsShowingDynamicWorkloadBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Context.TenantBranding.workload_branding_enabled},IsShowingDynamicWhrBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Support.isDefined(Context.TenantBranding.whr_key)&&Context.TenantBranding.whr_key==Context.TenantBranding.key},HideAndRemoveSlideAnimation:function(e){e.hide(),e.removeClass("slide")},RefreshDomainState:function(e){TenantBranding.IsDynamicBrandingEnabled()&&Support.checkIfDomainsMatch(e,Context.TenantBranding.prev_user)&&Support.isDefined(Context.TenantBranding.key)&&TenantBranding.PerformDynamicBranding(TenantBranding.IsShowingDynamicWhrBranding()?Context.TenantBranding.prev_key:Context.TenantBranding.key)},RemoveAllOldElements:function(){var e=$(".workload_text_old");e.remove();var t=$(".workload_img_old");t.hide(),t.remove(),$("#boiler_plate_old").remove(),void 0!=Constants.DEFAULT_BOILERPLATE_TEXT&&Constants.DEFAULT_BOILERPLATE_TEXT.length>0&&($("#boiler_plate_header").remove(),$("#boiler_plate").remove(),TenantBranding.AddBoilerPlateText(Constants.DEFAULT_BOILERPLATE_TEXT,Constants.DEFAULT_BOILERPLATE_HEADER))},ConfigureElementsForDelayedRemoval:function(){var e=$("#background_background_image").clone();e.attr("id","background_background_image_old").removeClass("slide"),$("#background_branding_container").prepend(e),$("#background_background_image").hide(),$(".workload_img").addClass("workload_img_old").removeClass("workload_img"),$(".workload_img_text").addClass("workload_text_old").removeClass("workload_text")},ResetOnLoadContext:function(){Background.background_resized=!1,Context.TenantBranding.has_logo=!1,Context.TenantBranding.has_background_img=!1,Context.on_load_image_background_loaded=!1,Logo.logo_image_loaded=!1},ResetDynamicBrandingContext:function(){"undefined"!=typeof window.LoginTenantBranding&&(Context.TenantBranding.prev_obj=window.LoginTenantBranding,window.LoginTenantBranding=null),Context.TenantBranding.prev_key=Context.TenantBranding.key,Context.TenantBranding.prev_user=Context.TenantBranding.user,Context.TenantBranding.applied=!1,Context.TenantBranding.has_logo=!1,Context.TenantBranding.has_background_img=!1},BackupWorkloadBranding:function(){if(!Context.TenantBranding.workload_branding_saved&&!Context.TenantBranding.default_page){Context.TenantBranding.workload_branding_saved=!0,Context.TenantBranding.workload_branding_illustration=$("#background_background_image").clone(),Context.TenantBranding.workload_branding_illustration_alt=$("#background_background_image").attr("alt"),Context.TenantBranding.workload_branding_logo=$("#login_workload_logo_image").clone(),Context.TenantBranding.workload_branding_logo_text=$("#login_workload_logo_text").clone(),Context.TenantBranding.workload_branding_logo_alt=$("#login_workload_logo_image").attr("alt"),Context.TenantBranding.workload_branding_color=$("html").css("background-color"),Context.TenantBranding.workload_branding_footer_height=$("#footer_links_container").height(),TenantBranding.BackupElementHeights();var e=Context.TenantBranding.cred_height;Context.TenantBranding.workload_branding_height=e}},ShouldShowWhrBranding:function(){return TenantBranding.IsShowingDynamicBranding()&&Support.isDefined(Context.TenantBranding.whr_key)?Context.TenantBranding.whr_key!=Context.TenantBranding.key||TenantBranding.IsShowingDynamicWorkloadBranding():!1},RemoveTenantBrandingAndApplyWorkload:function(){TenantBranding.IsDynamicBrandingEnabled()&&(Support.hideClientMessages(),Context.TenantBranding.enabled=!0,Support.isDefined(Context.TenantBranding.whr_key)?TenantBranding.ShouldShowWhrBranding()&&TenantBranding.PerformDynamicBranding(Context.TenantBranding.whr_key):TenantBranding.IsShowingDynamicWorkloadBranding()||TenantBranding.ApplyWorkloadBranding())},RemoveWorkloadBranding:function(){TenantBranding.BackupWorkloadBranding(),TenantBranding.ConfigureElementsForDelayedRemoval(),TenantBranding.ResetOnLoadContext()},PerformDynamicBranding:function(e){if(TenantBranding.IsDynamicBrandingEnabled()&&!Constants.FORCED_SIGN_IN){if(void 0==Context.TenantBranding.store.Get(e)&&(e=null),TenantBranding.IsShowingDynamicBranding()&&null!=Context.TenantBranding.key&&Context.TenantBranding.key==e&&!TenantBranding.IsShowingDynamicWorkloadBranding())return;Instrument.tenant_branding_getuserrealm_time=Instrument.home_realm_load_time,void 0==e||null==e||null!=Context.TenantBranding.key&&!TenantBranding.IsShowingDynamicWorkloadBranding()?void 0!=e&&null!=e&&null!=Context.TenantBranding.key&&e!=Context.TenantBranding.key?(Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,TenantBranding.ReplaceTenantBranding(e)):null==Context.TenantBranding.key||void 0!=e&&null!=e&&""!=e||(Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,TenantBranding.ApplyWorkloadBranding()):(Context.TenantBranding.default_page=!1,Context.TenantBranding.enabled=!0,Instrument.has_dynamic_tenant_branding=!0,Instrument.tenant_branding_number_of_switches++,Util.debug_console("workload branding -> tenant branding"),TenantBranding.RemoveWorkloadBranding(),TenantBranding.GetBrandingInfo(e))}},getTenantBrandingContext:function(e,t){var n={},o=[["BannerLogo",!0,Constants.DEFAULT_LOGO],["TileLogo",!0,""],["TileDarkLogo",!0,""],["Illustration",!0,Constants.DEFAULT_ILLUSTRATION],["BackgroundColor",!1,Constants.DEFAULT_BACKGROUND_COLOR],["CompanyName",!1,""],["UserIdLabel",!1,Constants.USERNAME_HINT_TEXT],["BoilerPlateText",!1,""],["KeepMeSignedInDisabled",!1,!1]];return $.each(o,function(o,i){var a=i[0],r=i[1];n[a]=e[t]&&e[t][a]?e[t][a]:e[0]&&e[0][a]?e[0][a]:i[2],"string"==typeof n[a]&&r&&(n[a]=n[a].toLowerCase())}),n},formatTenantBrandingData:function(e){var t={};return $.each(e,function(e,n){var o=n.Locale;o>=0&&(t[o]=n)}),t},processTenantBranding:function(e){null!=e&&(Instrument.has_tenant_branding=!0,e=TenantBranding.formatTenantBrandingData(e),Context.TenantBranding.info=e,Context.TenantBranding.info_context=TenantBranding.getTenantBrandingContext(e,Constants.LCID),TenantBranding.IsShowingDynamicBranding()||(TenantBranding.ShowBrandedBoilerPlate(),TenantBranding.UpdateLoginCtaText()),TenantBranding.ShowBrandedLogo(),TenantBranding.ShowBrandedIllustration(),Instrument.tenant_branding_process_end_time=Util.now())},BackupElementHeights:function(){Context.TenantBranding.footer_height_saved||(Context.TenantBranding.footer_height_saved=!0,Context.TenantBranding.footer_height=$("#footer_links_container").height()),Context.TenantBranding.cred_height_saved||(Context.TenantBranding.cred_height_saved=!0,Context.TenantBranding.cred_height=$(".cred").height())},AddBoilerPlateText:function(e,t){var n;if(Constants.IS_HOLOGRAPHIC)n=$("<label/>").attr("id","boiler_plate").text(Util.htmlDecode(e)),$(".footer_inner_container").html(n);else{var o=$("<p/>").attr("id","boiler_plate_header").attr("tabindex","-1").addClass("boilerplate_header").text(Util.htmlDecode(t));$(".boilerplate_header_location").before(o),n=$("<p/>").attr("id","boiler_plate").attr("tabindex","-1").addClass("tinytext").text(Util.htmlDecode(e)),$(".footer_inner_container").before(n)}},ShowBrandedBoilerPlate:function(){$("#boiler_plate").remove(),TenantBranding.BackupElementHeights(),$("#boiler_plate_header").remove();var e=Context.TenantBranding.info_context;TenantBranding.AddBoilerPlateText(e.BoilerPlateText||Constants.DEFAULT_BOILERPLATE_TEXT,null!=e.BoilerPlateText?Constants.BOILERPLATE_HEADER:Constants.DEFAULT_BOILERPLATE_HEADER),$("#boiler_plate").show(),TenantBranding.ShouldFadeInTenantBranding()&&($("#boiler_plate").removeClass("slide"),$("#boiler_plate").addClass("slide"));var t=50+$("#boiler_plate").height()+40;$(".login_inner_container").css("margin-bottom","-"+t+"px"),$(".login_footer_container").height(t),$(".push").height(t)},ShowBrandedLogo:function(){var e=Context.TenantBranding.info_context,t=Constants.IS_CXH_REQUEST?Constants.USE_DARK_TILE_LOGO?e.TileDarkLogo||e.TileLogo:e.TileLogo:e.BannerLogo;void 0!=t&&""!=t&&(t+="?ts="+Context.tenant_branding_ts),User.UpdateLogo(t,Constants.DEFAULT_LOGO_ALT),$("#login_workload_logo_text").hide()},ShowBrandedIllustration:function(){var e=Context.TenantBranding.info_context,t=e.Illustration;void 0!=t&&""!=t&&(t+="?ts="+Context.tenant_branding_ts),User.UpdateBackground(t,e.BackgroundColor)},StoreBrandingInfo:function(e,t){Context.TenantBranding.store.Add(e,t)},GetBrandingInfo:function(e){Instrument.tenant_branding_start_time=Util.now(),Context.tenant_branding_ts="",Context.TenantBranding.key=e,Context.TenantBranding.default_page&&(Context.TenantBranding.default_key=e),Context.TenantBranding.applied=!0,Context.TenantBranding.workload_branding_enabled=!1;var t=Context.TenantBranding.store.Get(e);void 0!=t&&(window.LoginTenantBranding=t,TenantBranding.ApplyTenantBranding())},ApplyTenantBranding:function(){"undefined"!=typeof window.LoginTenantBranding&&(Instrument.tenant_branding_json_end_time=Util.now(),Context.TenantBranding.store.Add(Context.TenantBranding.key,window.LoginTenantBranding),Constants.TENANT_BRANDING=window.LoginTenantBranding),null!=Constants.TENANT_BRANDING&&""!=Constants.TENANT_BRANDING&&(clearInterval(Context.tenant_branding_tid),Context.tenant_branding_tid=null,TenantBranding.processTenantBranding(Constants.TENANT_BRANDING))},ReplaceTenantBranding:function(e){TenantBranding.RemoveTenantBrandingDelayed(),TenantBranding.GetBrandingInfo(e)},RemoveTenantBrandingDelayed:function(){var e=$("#tenantbrandingscript");void 0!=e&&null!=e&&e.remove(),t=$(".workload_img_old"),void 0!=t&&null!=t&&t.remove();var t=$(".workload_img");void 0!=t&&null!=t&&t.addClass("workload_img_old").removeClass("workload_img");var n=$(".workload_text");void 0!=n&&null!=n&&n.addClass("workload_text").removeClass("workload_text_old");var o=$("#boiler_plate");void 0!=o&&null!=o&&o.attr("id","boiler_plate_old");var i=$("#background_background_image").clone();i.removeClass("slide"),i.attr("id","background_background_image_old"),$("#background_branding_container").prepend(i),$("#background_background_image").hide(),TenantBranding.ResetDynamicBrandingContext(),TenantBranding.ResetOnLoadContext(),TenantBranding.showKmsi(),TenantBranding.replaceUsernameHint()},RemoveTenantBranding:function(){var e=$("#tenantbrandingscript");void 0!=e&&null!=e&&e.remove(),t=$(".workload_img_old"),void 0!=t&&null!=t&&t.remove();var t=$(".workload_img");void 0!=t&&null!=t&&t.remove();var n=$(".workload_img_text");void 0!=n&&null!=n&&n.remove();var o=$("#boiler_plate");void 0!=o&&null!=o&&(Constants.DEFAULT_BOILERPLATE_TEXT.length>0?($("#boiler_plate_header").text(Constants.DEFAULT_BOILERPLATE_HEADER),o.text(Constants.DEFAULT_BOILERPLATE_TEXT)):o.remove(),$(".login_inner_container").css("margin-bottom","-50px"),$(".push").height(50)),$("#background_background_image").remove(),TenantBranding.ResetDynamicBrandingContext(),TenantBranding.ResetOnLoadContext(),TenantBranding.showKmsi(),TenantBranding.replaceUsernameHint()},ApplyWorkloadBranding:function(){if(Context.TenantBranding.workload_branding_enabled=!0,!Context.TenantBranding.workload_branding_saved||Context.TenantBranding.default_page)TenantBranding.RemoveTenantBrandingDelayed(),User.UpdateLogo(Constants.DEFAULT_LOGO,Constants.DEFAULT_LOGO_ALT),User.UpdateBackground(Constants.DEFAULT_ILLUSTRATION,Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").show(),Background.background_resized=!1,Context.on_load_image_background_loaded=!1,Logo.logo_image_loaded=!1;else{TenantBranding.RemoveTenantBranding(),Support.isDefined(Context.TenantBranding.workload_branding_illustration)&&$("#background_branding_container").prepend(Context.TenantBranding.workload_branding_illustration.clone()),Support.isDefined(Context.TenantBranding.workload_branding_logo)&&$(".login_workload_logo_container").append(Context.TenantBranding.workload_branding_logo.clone()),Support.isDefined(Context.TenantBranding.workload_branding_logo_text)&&$(".login_workload_logo_container").append(Context.TenantBranding.workload_branding_logo_text.clone()),User.RegisterOnLoadImage();var e=Context.TenantBranding.footer_height;e>0&&($("#footer_links_container").css("height",e+"px"),$("#footer_links_container").css("margin-top","-"+e+"px")),$("#background_page_overlay").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_branding_container").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("html").css("background-color",Constants.DEFAULT_BACKGROUND_COLOR),$("#background_background_image").removeClass("slide"),$(".workload_img").removeClass("slide"),$(".workload_img_text").removeClass("slide"),$("#background_background_image").hide(),$("#background_background_image").show(),$("#background_page_overlay").hide(),$(".workload_img").show(),$(".workload_img_text").show(),$("#background_background_image").addClass("slide"),$(".workload_img").addClass("slide"),$(".workload_img_text").addClass("slide"),Background.background_resized=!0,Context.on_load_image_background_loaded=!0,Logo.logo_image_loaded=!0}Context.TenantBranding.cred_height&&$(".cred").css("min-height",Context.TenantBranding.cred_height),Support.isDefined(Context.TenantBranding.workload_branding_login_cta_text)&&$("#login_cta_text").text(Context.TenantBranding.workload_branding_login_cta_text)},ShouldFadeInTenantBranding:function(){return TenantBranding.IsDynamicBrandingEnabled()&&(null!=Context.TenantBranding.key||Context.TenantBranding.workload_branding_saved)&&!Context.TenantBranding.default_page},UpdateLoginCtaText:function(){if("i5030.2.0"==$("meta[name=PageID]").attr("content")){(""==Context.TenantBranding.workload_branding_login_cta_text||null==Context.TenantBranding.workload_branding_login_cta_text)&&(Context.TenantBranding.workload_branding_login_cta_text=$("#login_cta_text").text());var e=$(".workload_img"),t=!1;if(Support.isDefined(e)){var n=null;n=e.attr("src"),Support.isDefined(n)&&Support.isDefined(Constants.DEFAULT_LOGO)&&(t=n.toLowerCase().indexOf(Constants.DEFAULT_LOGO.toLowerCase())>-1)}Constants.DYNAMIC_BRANDING_CTA_ENABLED&&!t&&$("#login_cta_text").text(Constants.PARTNER_NAME)}},onLoadLogoHelper:function(){Logo.logo_image_loaded=!0;var e=$(".workload_img");TenantBranding.HideAndRemoveSlideAnimation(e);var t=$(".workload_text");if(TenantBranding.HideAndRemoveSlideAnimation(t),Context.TenantBranding.has_logo?(e.show(),Instrument.logo_image_loaded=!0):(t.show(),Instrument.logo_image_loaded=!1),Instrument.logo_image_load_time=Util.now()-Instrument.logo_image_start,Instrument.tenant_branding_right_side_time=Util.now()-Instrument.tenant_branding_start_time,TenantBranding.RemoveAllOldElements(),TenantBranding.IsShowingDynamicWorkloadBranding()||TenantBranding.ShowBrandedBoilerPlate(),TenantBranding.UpdateLoginCtaText(),TenantBranding.ShouldFadeInTenantBranding()&&(e.addClass("slide"),t.addClass("slide")),Context.on_load_image_background_loaded)TenantBranding.onLoadImageHelper();else{$("#background_background_image_old").hide().remove();var n=Context.TenantBranding.background_color;$("#background_page_overlay").css("background-color",n),$("#background_branding_container").css("background-color",n),$("html").css("background-color",n),$("#background_background_image").css("background-color",n),$("#background_background_image").hide()}TenantBranding.setUserIdHintAndKmsi(),Util.debug_console("onLoadLogo: Logo successfully loaded.")},setUserIdHintAndKmsi:function(){null!=Context.TenantBranding.info_context&&(Context.TenantBranding.info_context.KeepMeSignedInDisabled&&!TenantBranding.IsShowingDynamicWorkloadBranding()?($("#cred_kmsi_container").hide(),$("#cred_keep_me_signed_in_checkbox").attr("checked",!1)):TenantBranding.showKmsi(),null==Context.TenantBranding.info_context.UserIdLabel||0==Context.TenantBranding.info_context.UserIdLabel.length||TenantBranding.IsShowingDynamicWorkloadBranding()?TenantBranding.replaceUsernameHint():(TenantBranding.setUsernameHint(Context.TenantBranding.info_context.UserIdLabel),Context.TenantBranding.username_hint_changed=!0))},showKmsi:function(){$("#cred_kmsi_container").show()},replaceUsernameHint:function(){Context.TenantBranding.username_hint_changed&&(TenantBranding.setUsernameHint(Constants.USERNAME_HINT_TEXT),Context.TenantBranding.username_hint_changed=!1)},setUsernameHint:function(e){var t=Util.htmlDecode(e);Support.is_placeholder_supported()?$("#cred_userid_inputtext").attr("placeholder",t):$("#cred_userid_inputtext_placeholder_span").text(t),$("#cred_userid_inputtext").attr("alt",t)},onLoadImageHelper:function(){if(Logo.logo_image_loaded){Instrument.tenant_branding_total_time=Util.now()-Instrument.tenant_branding_start_time;var e=$("#background_background_image"),t=$("#background_page_overlay");TenantBranding.HideAndRemoveSlideAnimation(e),$("#background_background_image_old").remove(),t.css("visibility","visible");var n=$("html").css("background-color");n=Context.TenantBranding.background_color,t.css("background-color",n),$("#background_branding_container").css("background-color",n),$("html").css("background-color",n),Context.TenantBranding.has_background_img&&(e.show(),TenantBranding.ShouldFadeInTenantBranding()&&e.addClass("slide"),e.css("background-color",n),t.css("z-index","-1"),t.hide()),Util.debug_console("TenantBranding OnLoadImage: Background was resized.")}},onLoadImageError:function(){TenantBranding.IsShowingDynamicBranding()&&(Context.TenantBranding.has_background_img=!1)},onLoadLogo:function(){var e=$("#login_workload_logo_image");Util.debug_console("onLoadLogo: Called"),!Logo.logo_image_loaded&&User.IsImageLoaded(e)&&TenantBranding.onLoadLogoHelper()},onLoadErrorLogo:function(){if(!Logo.logo_image_loaded){User.UpdateLogo("",Constants.DEFAULT_LOGO_ALT);var e=$(".workload_img_old");e.hide(),e.remove(),Logo.logo_image_loaded=!0,Instrument.logo_image_error=!0}},RestoreDefaultPageBranding:function(){"undefined"!=typeof Constants.DEFAULT_BRANDING?Context.TenantBranding.applied&&Context.TenantBranding.key==Constants.DEFAULT_BRANDING||TenantBranding.GetBrandingInfo(Constants.DEFAULT_BRANDING):TenantBranding.RemoveTenantBrandingAndApplyWorkload()
}};var TenantBranding=MSLogin.TenantBranding,users=null;MSLogin.Tiles={tile_showing_user_cred:!0,users:null,cred_length_resized:!1,showUser:function(e,t,n,o){Tiles.tile_showing_user_cred||($("#login_user_chooser table").hide(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),Tiles.updateFirstUserTile(e,t,n),$("#login_user_chooser table:first").show(),$.each(users,function(i,a){a.login.toLowerCase()!=e.toLowerCase()||a.isLive!==t&&a.domainHint!==n||(""!=a.authUrl||""!=a.domainHint&&"undefined"!=typeof a.domainHint?Tiles.showFederatedTileUser(a):Tiles.showManagedTileUser(a,o))}),Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Tiles.tile_showing_user_cred=!0)},hideDisambiguationScreen:function(){$("#splitter-tiles-container").hide(),$("#cred_kmsi_container").show(),$("#cred_sign_in_button").show(),User.tryShowCancelButton(),$("#recover_container").show(),$("#alternative-identity-providers").show(),$("#disambig-container").hide(),$("#login-splitter-control").hide(),$("#splitter-tiles-container").children("a").remove(),$("#splitter-tiles-container").hide(),$("#login_user_chooser").empty(),$(".login_user_chooser").hide(),$("#login_user_chooser").hide(),$("#create_msa_account_container").hide()},showUserLoginPage:function(){$(".login_user_chooser").show(),$("#cta_error_message_text").show(),$("div.progress").css("visibility","hidden"),clearInterval(Context.animationTid),Support.hideClientErrorMessages(),Support.hideClientMessages(),Context.username_state.home_realm_state=Constants.State.NONE,Context.username_state.last_checked_email=Context.username_state.last_checked_email||"",$(".cta_message_text").show(),$("#cred_userid_container").show(),$("#cred_userid_inputtext").show(),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$("#cred_userid_inputtext").focus()},showManagedTileUser:function(e,t){Tiles.disableActiveTile(),Context.post_from_tile=!0,$(".login_cred_container").show(),$(".login_cred_field_container").show(),$(".login_cred_container li").show(),$("#disambig-container").hide(),$("#signin_legend").hide(),$("#cred_userid_inputtext").val(Util.htmlDecode(e.login)),$("#cred_password_container").show(),$(".login_cred_options_container").show(),Context.username_state.enable_guests=!1,$("#guest_hint_text").hide(),$(".guest_redirect_container").hide(),User.tryShowCancelButton(),Util.EnableEmailDiscoveryIfEBD(),$("#cred_sign_in_button").show(),$("#cred_password_inputtext").focus(),t||User.RefreshDomainState(),e.fido20Challenge&&window.proxy.FIDO.getAssertion(e.fido20Challenge,Util.htmlDecode(e.login),Constants.Fido20_GetAssertionUserPrompt.format(Util.htmlDecode(e.login)),function(e){$("#assertion").val(JSON.stringify(e)),$("#ngccredentials").submit()},function(){$("#assertion").val("")})},showFederatedTileUser:function(e){Context.username_state.home_realm_state=Constants.State.FEDERATED,Context.post_from_tile=!0,Tiles.disableActiveTile(),$("#cred_userid_inputtext").val(Util.htmlDecode(e.login)),$(".login_cred_field_container").show(),$(".login_cred_options_container").show(),$(".login_cred_options_container div.subtext").hide(),$("#cred_sign_in_button").hide(),$("#forget_tile_container").show(),$("#cred_password_container").hide(),$(".login_cta_container").hide(),$("#recover_container").hide(),$("#redirect_cta_text").show(),$("input#cred_password_inputtext").hide(),$("#redirect_company_name_text").empty(),$("#cred_kmsi_container").show(),$("#alternative-identity-providers").hide(),$("div.progress").css("visibility","visible"),User.startAnimation(),Context.animationTid=setInterval(User.startAnimation,3500),Context.username_state.enable_progress_bar=!0,Context.username_state.enable_redirect=!0,Context.username_state.enable_guests=!1,Util.EnableEmailDiscoveryIfEBD(),Util.updateRedirectionMessage(e.authUrl),Context.redirect_auth_url=e.authUrl,User.UsernameOnChangeHandler(),User.StartRedirection(!1)},disableActiveTile:function(){$("#login_user_chooser .tile_link:first .user_tile").addClass("disabled_tile"),$("#login_user_chooser .tile_link:first").addClass("disabled_tile"),$("#login_user_chooser .tile_link:first").attr("tabindex","-1"),$("#login_user_chooser .tile_link:first tr").css("cursor","default"),$(".tile_primary_name").css("cursor","default"),$(".tile_secondary_name").css("cursor","default")},enableActiveTile:function(){$("#login_user_chooser .tile_link:first .user_tile").removeClass("disabled_tile"),$("#login_user_chooser .tile_link:first").removeClass("disabled_tile"),$("#login_user_chooser .tile_link:first").attr("tabindex","1"),$("#login_user_chooser .tile_link:first tr").css("cursor","pointer"),$(".tile_primary_name").css("cursor","pointer"),$(".tile_secondary_name").css("cursor","pointer")},showOtherOption:function(){if(!Tiles.tile_showing_user_cred){if($("#alternative-identity-providers").show(),EmailDiscovery.IsTilesModeActivated()||EmailDiscovery.ShouldPerformDiscovery())return Tiles.tile_showing_user_cred=!0,Context.back_action_stack.AddAction(Constants.CancelAction.FROM_EMAILDISCOVERY_START_TO_TILES),EmailDiscovery.Init(),void $("#cred_userid_inputtext").val("");Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Context.username_state.enable_progress_bar=!0,User.UsernameOnChangeHandler(),$(".login_cred_container").show(),$(".login_cred_container .windows_cred_block").show(),$(".login_cred_field_container").addClass("show_other"),$(".login_cred_field_container").show(),$("#cred_userid_container").show(),$("#login_user_chooser").hide(),$(".login_cred_options_container").show(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#forget_tile_container").hide(),$("#cred_sign_in_button").show(),User.tryShowCancelButton(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$("#cred_userid_inputtext").val(""),$("#cred_userid_inputtext").focus(),Context.username_state.enable_guests=!0,Tiles.tile_showing_user_cred=!0,Support.renderBrowserSpecific()}},CancelTileRedirect:function(){Context.redirect_to_manage=!1,$("#cred_password_inputtext").val(""),Context.username_state.last_checked_email="",Tiles.enableActiveTile(),$("#cred_password_inputtext").val(""),$("#cta_error_message_text").remove(),$(".login_cred_field_container").removeClass("show_other"),$(".login_cred_field_container").hide(),$(".login_cred_options_container").hide(),$(".login_userid_container").hide(),$(".login_cred_options_container div.subtext").show(),$("#create_msa_account_container").hide(),$("#cred_sign_in_button").show(),$("#cred_kmsi_container").show(),$("#forget_tile_container").show(),User.tryShowCancelButton(),Tiles.tile_showing_user_cred=!1,Support.hideClientErrorMessages(),User.CancelRedirect(),$("#login_user_chooser").empty(),Tiles.drawUsers()},getStringTileID:function(e,t){var n;if(void 0==e.id){for(n=Util.htmlDecode(e.login).replace("@","_");n.indexOf(".")>0;)n=n.replace(".","_");for(;n.indexOf(" ")>0;)n=n.replace(" ","_");for(;n.indexOf("'")>0;)n=n.replace("'","_");(e.isLive||"msa"===e.domainHint)&&(n+="-live"),t&&(n="use_another_account"),n=n.toLowerCase()}else n=e.id;return n},drawTile:function(e,t,n){var o=e.name,i=e.login,a=e.name,r=e.login,s=null,d=null;e.isLive?(s=Constants.MSA_ACCOUNT_TILE_ALT_TEXT.replace("{0}",e.name),d=Constants.MSA_ACCOUNT_IMG_ALT_TEXT):(s=Constants.AAD_ACCOUNT_TILE_ALT_TEXT.replace("{0}",e.name),d=e.domainHint?e.domainHint:Constants.AAD_ACCOUNT_IMG_ALT_TEXT);var _=e.sessionID?e.sessionID:"";""===o&&""!==i&&(o=i,a=r,i=r=""),o.toLowerCase()==i.toLowerCase()&&(i=r="");var c=void 0==e.ignore_length||0==e.ignore_length;(!c||Util.htmlDecode(o).length<Constants.MAX_TILE_TEXT_LENGTH)&&(a=""),(!c||Util.htmlDecode(i).length<1.6*Constants.MAX_TILE_TEXT_LENGTH)&&(r="");var l=!1,u="",g="",m=null;$("meta[name=PageID]").attr("content").indexOf("reauth")>=0?(l=!0,u="<div/>",g="alt"):e.isWindows?(u="<a />",g="href",m=e.sessionID&&e.isSigned?function(){var t=Constants.BASE_URL+$.param({sessionId:e.sessionID,ctx:Constants.CONTEXT});User.Redirect(t)}:function(){window.WindowsBrowserSso.LoginWindowsUser(e.link,Tiles.getStringTileID(e,!1))}):Context.email_discovery_mode?(u="<a/>",g="href",m=e.isLive?function(){Context.email_discovery_easi_user=!0,Instrument.email_discovery_splitter_choice=EmailDiscovery.WorkflowStates.MSA,EmailDiscovery.LoginMSOAccount()}:function(){Instrument.email_discovery_splitter_choice=EmailDiscovery.WorkflowStates.AAD,EmailDiscovery.LoginAADAccount()},s=e.name,d=e.name):"other"==e.link?(u="<a/>",g="href",m=Tiles.showOtherOption,s=e.name,d=e.name):e.isSigned?(u="<a />",g="href",m=Constants.IS_MSA_FED_SUPPORTED&&e.isLive&&!Constants.IS_LOGOUT_REQUEST?User.GetRedirectAction(Constants.MSA_AUTH_URL,Constants.appRedirectUrl,Constants.msaRedirErrorParams,Util.htmlDecode(e.login)):function(){var t=Constants.BASE_URL+$.param({sessionId:e.sessionID,ctx:Constants.CONTEXT});User.Redirect(t)}):""!=e.link?(u="<a/>",g="href",m=function(){Tiles.showUser(e.link,e.isLive,e.domainHint)}):(u="<div/>",g="alt");var p="other"==e.link||Context.email_discovery_mode||l||n||!1,h=Tiles.getStringTileID(e,p),C=this.generateUserTileHtml(Util.htmlEncode(h),_,t,d,o,a,i,r,p?null:e.isSigned?e.isWindows?Constants.CONNECTEDTOWINDOWS:Constants.SIGNEDIN:Constants.CLICKTOSIGNIN,p||e.isWindows||Constants.IS_LOGOUT_REQUEST?null:e.isSigned?"signedin":"signedout",e.isWindows);return $("#login_user_chooser").append($(u).attr("id",h+"_link").attr("data-session-id",_).attr(g,"#").attr("tabindex","1").addClass("tile_link").addClass("tooltip").click(m).append(C)),$("#"+h+"_link").each(function(e,t){t.setAttribute("aria-label",Util.htmlDecode(s))}),$("#use_another_account_link").attr("tabindex","4"),$("#"+h+"_menulink").keydown(function(e){var t=$(this).attr("data-ref"),n=$("#"+t+"-dropdown");switch(e.which){case 32:case 13:$(this).click(),e.preventDefault();break;case 27:n.hide()}}).click(function(e){e.preventDefault(),e.stopPropagation();var t=$(this).attr("data-ref"),n=$(this).attr("data-session-id"),o=$("#"+t+"-dropdown"),i=$(".dropdownPanel");if(o.is(":visible"))i.hide();else{var a=$(this).position();i.hide(),o.removeClass("hidden").removeAttr("aria-hidden").css({left:a.left-o.width()+20+"px",top:a.top+15+"px"}).show(),o.find("li").removeAttr("aria-hidden").attr("data-session-id",n).attr("tabindex","3").show()}}),h+"_link"},drawUsers:function(){Tiles.users||(Tiles.users=users=[]),Tiles.users.length>1||1===Tiles.users.length&&"other"!=Tiles.users[0].link?($(".login_cta_container").css("visibility","visible"),$("#login_cta_text").hide(),$("#tiles_cta_text").show(),$(".login_cred_container li").hide(),$(".login_cred_container .windows_cred_block").hide(),$("#login_user_chooser").show(),$("#cred_userid_container").hide(),$("#switch_user_container").hide(),Tiles.drawUserTiles()):Tiles.showOtherOption()},drawUserTiles:function(){Tiles.cred_length_resized=!0;var e="";if($.each(users,function(t,n){e=Tiles.getUserImage(n);var o="";if("other"==n.link||t<Constants.MAX_USER_TILES||Context.email_discovery_mode){var i=!Constants.IS_MSA_FED_SUPPORTED&&n.isLive;o=Tiles.drawTile(n,e,i)}""!=o&&0==t&&$("#"+o).focus()}),Tiles.tile_showing_user_cred=!1,Context.username_state.enable_guests=!0,!Tiles.cred_length_resized){var t=$(".cred").height();t+=$(".login_user_chooser").height(),$(".cred").css("min-height",t),Tiles.cred_length_resized=!0}Support.renderBrowserSpecific(),Context.TenantBranding.cred_height?$(".cred").css("min-height",Context.TenantBranding.cred_height):$(".cred").css("min-height","")},forgetAccount:function(){Tiles.tile_showing_user_cred=!1,$("#forget_tile_container").hide(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),Util.eraseCookie("MSPPre"),Tiles.CancelTileRedirect(),Tiles.showOtherOption(),User.tryShowCancelButton()},forceSignIn:function(e){Tiles.disableActiveTile(),Tiles.tile_showing_user_cred=!1,$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#login_user_chooser table").hide(),$("#login_user_chooser table:first").show(),$("#switch_user_container").show();var t=null;$.each(users,function(n,o){o.login.toLowerCase()!=e.toLowerCase()||o.isLive||"undefined"!=typeof o.domainHint&&""!=o.domainHint||(Tiles.showManagedTileUser(o),t=o)}),User.tryShowCancelButton(),$("#forget_tile_container").hide();var n=!1;null!=t&&null!=t.isLive&&Tiles.ApplyToEachSavedUsers(function(o){0!=o[0].length&&o[0].toLowerCase()==e.toLowerCase()&&o[1]==(t.isLive?"1":"0")&&(n=!1)}),n?$("#cred_keep_me_signed_in_checkbox").attr("checked","checked"):$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").show()},hasUserNameQS:function(){var e=Util.ExtractQSParam("username")+Util.ExtractQSParam("login_hint");return""!=e},showUserName:function(){var e=Util.ExtractQSParam("username");""==e&&(e=Util.ExtractQSParam("login_hint")),e=decodeURIComponent(e);var t=null,n=!1;$.each(Tiles.users,function(o,i){Util.htmlDecode(i.login).toLowerCase()!=e.toLowerCase()||n||(n=!0,t=i)}),n?(Tiles.showUser(t.login,t.isLive,t.domainHint),$("#cred_password_inputtext").focus()):(Tiles.showOtherOption(),$("#cred_userid_inputtext").val(e),$("#cred_userid_inputtext").focus())},showIsNotMe:function(e,t,n){Tiles.drawUsers(),Tiles.showUser(e,t,n),$(".login_cred_container li").hide(),$("#login_user_chooser").show("slow"),$(".login_cta_container").show(),$(".login_cta_container").css("visibility","visible"),$(".login_cred_options_container").show(),$(".login_cred_options_container div.subtext").hide(),$("#submit_button").hide(),$("#continue_as_user_container").show(),$("#continue_as_user_link").focus(),$("#switch_user_container").show()},updateContinueAsUserUrl:function(e){var t=$("#continue_as_user_link").attr("href");t=t.replace("post.srf","secure.srf"),t=t.replace(new RegExp("username=[^\\&]*","gm"),""),t.indexOf("msoptin-newui")<0&&(t+="&msoptin-newui"),$("#continue_as_user_link").attr("href",t),t=Util.ExtractQSParam("ru"),""!=t&&(t=e,$("#continue_as_user_link").attr("href",t))},forgetUserFromCookie:function(e,t){Tiles.tile_showing_user_cred=!1,$("#forget_tile_container").hide(),$("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide(),$("#login_userid_inputtext").val(""),$("#login_password_inputtext").val(""),Tiles.CancelTileRedirect(),TenantBranding.RemoveTenantBrandingAndApplyWorkload();var n=[];Tiles.ApplyToEachSavedUsers(function(o){(0==o[0].length||o[0].toLowerCase()!=e.toLowerCase()||o[1]!=Number(t).toString())&&n.push([o[0],o[1],o[2]])});var o=Util.getCookie(Constants.PREFILL_USER_COOKIE);if(0==n.length)return Util.eraseCookie(Constants.SAVED_USER_COOKIE),EmailDiscovery.IsTilesModeActivated()&&(Context.email_discovery_tiles_mode=!1,Context.email_discovery_mode=!0),Tiles.showOtherOption(),$("#login_user_chooser").hide(),Context.back_action_stack.ClearCancelActions(),User.tryShowCancelButton(),void(null!=o&&o.indexOf(e)>=0&&Util.eraseCookie(Constants.PREFILL_USER_COOKIE));var i=Constants.SAVED_USER_COOKIE_INFO_DELIMITER,a="";$.each(n,function(e,t){e&&(a+=Constants.SAVED_USER_COOKIE_USER_DELIMITER),a+=t[0]+i+t[1]+i+t[2]}),Util.setCookie(Constants.SAVED_USER_COOKIE,a,30),Util.eraseCookie(Constants.PREFILL_USER_COOKIE),location.reload()},ApplyToEachSavedUsers:function(e){var t=Util.getCookie(Constants.SAVED_USER_COOKIE),n=Constants.SAVED_USER_COOKIE_USER_DELIMITER,o=Constants.SAVED_USER_COOKIE_INFO_DELIMITER;void 0!=t&&null!=t&&""!=t&&$.each(t.split(n),function(t,n){if(void 0!=n&&null!=n&&""!=n){var i=n.split(o);3==i.length&&0!=i[0].length&&e(i)}})},getUser:function(e,t,n){e=e.toLowerCase();var o=null;return $.each(Tiles.users,function(i,a){(a.login.toLowerCase()==e&&(a.isLive===t||a.domainHint===n)||a.sessionID==e)&&(o=a)}),o},forgetRememberedUser:function(e){var t=$(this).parent().attr("data-session-id");Support.isDefined(t)?$.ajax({headers:{Accept:"application/json"},url:"/forgetuser",dataType:"json",data:{sessionId:encodeURI(t)},success:function(e){Tiles.UpdateUsers(e)},error:function(e,t,n){Support.showClientError(n)},timeout:2e3}):Util.debug_console("sessionId is not defined"),e.preventDefault()},indexOfPropValue:function(e,t,n){for(var o="string"==typeof n?n.toLowerCase():n,i=0;i<e.length;i++){var a="string"==typeof e[i][t]?e[i][t].toLowerCase():e[i][t];if(a==o)return i}return-1},mergeUsers:function(e,t){e=e.slice(0),t=t.slice(0);for(var n=0;n<e.length;n++){var o=e[n],i=Tiles.indexOfPropValue(t,"login",Util.htmlDecode(o.login));if(i>-1&&(o.isSigned||(e[n]=t[i]),t.splice(i,1),0==t.length))break}return e.concat(t)},redirectToManage:function(){var e=$(this).parent().attr("data-session-id"),t=$(this).attr("data-ref"),n=$("#"+t+"-dropdown");n.hide(),$("#login_user_chooser table").hide(),$(".login_cta_container").css("visibility","visible"),$("#login_cta_text").show(),$("#tiles_cta_text").hide();var o=Tiles.getUser(e);Tiles.updateFirstUserTile(o.login,o.isLive,o.domainHint),$("#login_user_chooser table:first").show(),Context.redirect_to_manage=!0,o.isSigned?window.location.href=o.isLive||"msa"===o.domainHint?"@Html.Raw(CloudStsSettings.Current.ManageMicrosoftAccountProfileUri)":"@Html.Raw(CloudStsSettings.Current.ManageUserProfileUri)":""==o.authUrl?Tiles.showManagedTileUser(o):(o.authUrl+="&LoginOptions=1"+($("#cred_keep_me_signed_in_checkbox").attr("checked")?"1":"0"),Tiles.showFederatedTileUser(o)),Context.back_action_stack.AddAction(Constants.CancelAction.FROM_SHOW_USER_TO_TILES),Tiles.tile_showing_user_cred=!0},UpdateUsers:function(e){Tiles.sso_users&&(e=Tiles.mergeUsers(e,Tiles.sso_users)),Constants.IS_USE_OTHER_ACCOUNT_VISIBLE&&e.push(Tiles.otherJSON),Tiles.users=users=e,$("#login_user_chooser").empty(),Tiles.drawUsers()},signoutAndForgetUser:function(e){var t=$(this).parent().attr("data-session-id"),n=e.data.shouldForgetUser,o=$("#title3_"+t);Support.isDefined(t)?(o.text(Constants.SIGNINGOUT),$(this).append('<iframe name="logoutFrame" src="'+Constants.SIGNOUTFORGET_URL_TEMPLATE.format(t,n)+'" style="display: none"></iframe>')):Util.debug_console("seesionId is not defined"),e.preventDefault()},updateFirstUserTile:function(e,t,n){$("input#cred_userid_inputtext").val(Util.htmlDecode(e)),$("#login_user_chooser").empty();var o=Tiles.getUser(e,t,n),i=Tiles.getUserImage(o),a=Tiles.drawTile(o,i,!0);$("#"+a).focus()},getUserImage:function(e){var t="work_account.png";return t=e.domainHint&&!Constants.IS_CXH_REQUEST?-1!=$.inArray(e.domainHint,["amazon","facebook","google","instagram","linkedin","qq","renren","twitter","weibo","yahoo"])?e.domainHint+"_80.png":"msa"===e.domainHint?"personal_account.png":"use_another_account.png":"other"===e.link?"use_another_account.png":e.isLive?"personal_account.png":"work_account.png",Constants.CDN_IMAGE_PATH+t},generateUserTileHtml:function(e,t,n,o,i,a,r,s,d,_,c){var l="";null!=d?l='            <div class="smallertext tile_third_name windows_tile_text text-caption2 {0}" style="cursor: pointer" id="title3_{1}">                {2}            </div>'.format(e,t,d):Context.username_state.last_checked_email&&(l='            <div class="smallertext tile_third_name windows_tile_text text-caption2 {0}" style="cursor: pointer">                {1}            </div>'.format(e,Context.username_state.last_checked_email));var u="";null!=_&&(u=('        <td class="dots" rowspan="2">            <div id="{0}_menulink" tabindex="2" data-ref="{2}" data-session-id="{1}" title="'+Constants.CLICKFORMORE+'" aria-label="'+Constants.CLICKFORMORE+'">                &bull;&bull;&bull;            </div>        </td>').format(e,t,_));var g="";c&&(g='                         <div class="progress">                             <div class="pip"></div>                             <div class="pip"></div>                             <div class="pip"></div>                             <div class="pip"></div>                             <div class="pip"></div>                         </div>');var m=('<table id="{0}" data-session-id="{1}" class="user_tile">    <tr>        <td>            <table>                 <tr>                     <td colspan="2">'+g+"                     </td>"+u+'                 </tr>                 <tr class="{0} {1}" style="cursor: pointer">                     <td>                         <img class="ad_glyph {0}" src="{2}" alt="{3}" />                     </td>                     <td class="tile_name tile_name_padding">                         <div class="bigtext tile_primary_name windows_tile_text wrap {0}" style="cursor: pointer" {5}>                             {4}                         </div>                         <div class="smallertext tile_secondary_name windows_tile_text text-caption2 {0}" style="cursor: pointer" {7}>                             {6}                         </div>'+l+"                     </td>                 </tr>            </table>        </td>    </tr></table>").format(e,t,n,o,i,a?'title="'+a+'"':"",r,s?'title="'+s+'"':"");return m}};var Tiles=MSLogin.Tiles;!function(){var e=window,t=e.MSLogin=e.MSLogin||{};t.Util={HoloNavigationStack:[],PrefetchContent:function(e){$("#login_prefetch_container").append($("<iframe/>").attr("src",e).attr("seamless","seamless").attr("scrolling","no").attr("id","login_prefetch_iframe").load(function(){Instrument.prefetch_load_time=new Date-Instrument.prefetch_start,Instrument.prefetch_done=!0}))},getCookie:function(e,t){var n,o,i,a=document.cookie.split(";");for(n=0;n<a.length;n++)if(o=a[n].substr(0,a[n].indexOf("=")),i=a[n].substr(a[n].indexOf("=")+1),o=o.replace(/^\s+|\s+$/g,""),o==e)return(t||window.unescape)(i)},setCookieWithExpiration:function(e,t,n,o){var i=";secure";"undefined"!=typeof Constants&&"undefined"!=typeof Constants.SET_COOKIE_SUFFIX&&(i=Constants.SET_COOKIE_SUFFIX);var a=t+(o?";domain="+o:"")+";path=/"+(n?";expires="+n.toUTCString():"")+i;document.cookie=e+"="+a},setCookie:function(e,t,n){var o=new Date;o.setDate(o.getDate()+n);var i=document.location.hostname.split("."),a=i.length,r="."+i[a-2]+"."+i[a-1];Util.setCookieWithExpiration(e,t,o,r)},eraseCookie:function(e){var t=document.location.hostname.split("."),n=t.length,o=e+"= ;domain=."+t[n-2]+"."+t[n-1]+";path=/;expires=Thu, 30-Oct-1980 00:00:01 GMT;";Util.debug_console(o),document.cookie=o,o=e+"= ;domain=."+document.location.hostname+";path=/;expires=Thu, 30-Oct-1980 00:00:01 GMT;",Util.debug_console(o),document.cookie=o},exists:function(e){return e?!0:0==e||0==e||""==e},valOrDefault:function(e,t){return Util.exists(e)?e:t},debug_console:function(){},ExtractToken:function(e,t,n,o,i){n=Util.valOrDefault(n,"&"),o=Util.valOrDefault(o,"=");var a=Util.valOrDefault(i,null);if(!e)return a;var r=e.indexOf(t+o);if(0==r?r+=t.length+1:r>0&&(r=e.indexOf(n+t+o),r>0&&(r+=n.length+t.length+1)),-1!=r){var s=e.indexOf(n,r);-1==s&&(s=e.length),a=e.substring(r,s)}return a},ExtractQSParam:function(e){var t=Context.query_search_params.toLowerCase();return t&&(t=t.substr(1)),Util.ExtractToken(t,e.toLowerCase(),"&","=","")},AddQSParamIfNotExists:function(e,t,n){var o="[?&]"+t+"=([^&]+?)($|&)",i=new RegExp(o,"i"),a=e.match(i);if(!a){var r="([?&])"+t+"=?(&|$)",s=new RegExp(r,"i");e=e.replace(s,"$1");var d=Util.ExtractQSParam(t);!d||n&&!n.test(d)||(-1==e.indexOf("?")?e+="?":e.indexOf("?")<e.length-1&&(e+="&"),e+=t+"="+d)}return e},appendQueryString:function(e,t){var n=-1===e.indexOf("?")?"?":"&";return e+n+t},isMSA:function(e){return-1!=e.indexOf("login.live.com")||-1!=e.indexOf("login.live-int.com")||-1!=e.indexOf("login.microsoft.com")||-1!=e.indexOf("/MockLiveINT/")?!0:!1},updateRedirectionMessage:function(e){var t;Util.isMSA(e)?t=Constants.REDIRECT_MESSAGES.MSA:(t=Constants.REDIRECT_MESSAGES.AAD,$("#alternative-identity-providers").hide()),$("#redirect_message_text").text(t)},htmlEncode:function(e){return $("<span/>").text(e).html()},htmlDecode:function(e){return $("<span/>").html(e).text()},now:function(){var e=window.performance||{};return e.now=function(){return e.now||e.webkitNow||e.msNow||e.oNow||e.mozNow||function(){return(new Date).getTime()}}(),e.now()},StartLocalAccountCxhFlow:function(){try{var e=new CloudExperienceHost.Bridge;return e.fireEvent(CloudExperienceHost.Events.loadIdentityProvider,CloudExperienceHost.SignInIdentityProviders.Local),!1}catch(t){}return!0},CancelCxhFlow:function(){try{var e=new CloudExperienceHost.Bridge;return e.fireEvent(CloudExperienceHost.Events.done,CloudExperienceHost.AppResult.cancel),!1}catch(t){}return!0},OnBack:function(){var e=Util.HoloNavigationStack;return e.pop(),e[e.length-1].show&&e[e.length-1].show(),!1},NavigateCxh:function(e){try{var t=new CloudExperienceHost.Bridge;return t.fireEvent(CloudExperienceHost.Events.navigate,e),!1}catch(n){}return!0},LogCxhTelemetry:function(e,t){try{var n=new CloudExperienceHost.Bridge;void 0==t?n.invoke("CloudExperienceHost.Telemetry.logEvent",e):n.invoke("CloudExperienceHost.Telemetry.logEvent",e,t)}catch(o){}},EnableEmailDiscoveryIfEBD:function(){("EmailBasedDiscovery.2.0"==$("meta[name=PageID]").attr("content")||"EmailBasedDiscoveryTiles.2.0"==$("meta[name=PageID]").attr("content"))&&($("#cred_keep_me_signed_in_checkbox").removeAttr("checked"),EmailDiscovery.is_enabled_workflow=!0)}},e.Util=t.Util}(),MSLogin.WindowsBrowserSso={STATE:{START:"start",INPROGRESS:"in-progress",END:"end",END_SSO:"end-sso",END_USERS:"end-users"},Initialize:function(e){this.options=e||{forceTiles:!1,overallTimeoutMs:4e3},this.options.initiatePullTimeoutMs=this.options.initiatePullTimeoutMs||this.options.overallTimeoutMs,this.options.initiatePullTimeoutAction=this.options.initiatePullTimeoutAction||"abort",this.bsso=Util.ExtractQSParam("bsso").toLowerCase(),this.log=[]},LoginWindowsUser:function(e,t){if(!window.navigator||!$.isFunction(window.navigator.msLaunchUri)||"disable"==this.bsso)return this.updateStatus(this.STATE.START,null,t),this.reportTelemetry("BSSO.info","disable"==this.bsso?"disabled":"not-supported"),void this.updateStatus(this.STATE.END,"disable"==this.bsso?"Browser SSO is disabled":"window.navigator.msLaunchUri is not available",t);var n,o=this;$.when($.Deferred(function(i){n=o.callTokenBroker(e,i,"Windows user login",t)})).then(function(){var e,i=setInterval(function(){if(Util.getCookie("ESTSSSO")){clearInterval(i),clearTimeout(e);var a=(new Date).getTime()-n;o.reportTelemetry("ESTSSSO.cookie.ms",a),o.reloadPage(t)}},100);e=setTimeout(function(){clearInterval(i);var e=(new Date).getTime()-n;o.reportTelemetry("TB.response.timeout.ms",e),o.updateStatus(o.STATE.END,"Windows user login timed out.",t)},o.options.overallTimeoutMs)})},PullBrowserSsoCookie:function(){if(!window.navigator||!$.isFunction(window.navigator.msLaunchUri)||"disable"==this.bsso)return this.updateStatus(this.STATE.START,null),this.reportTelemetry("BSSO.info","disable"==this.bsso?"disabled":"not-supported"),void this.updateStatus(this.STATE.END,"disable"==this.bsso?"Browser SSO is disabled":"window.navigator.msLaunchUri is not available");var e=Util.getCookie("ESTSSSOTILES")||this.options.forceTiles;if(!e&&Util.getCookie("SSOCOOKIEPULLED"))return this.updateStatus(this.STATE.START,null),this.reportTelemetry("BSSO.info","throttled"),void this.updateStatus(this.STATE.END,"Cookie pull throttled");var t,n=this,o="tbauth://login.windows.net?context="+encodeURIComponent(window.location.href.split("/",3).join("/"))+(n.options.nonce?"&request_nonce="+encodeURIComponent(n.options.nonce):"")+(n.options.rid?"&rid="+encodeURIComponent(n.options.rid):"");$.when($.Deferred(function(i){var a=o;e&&(a=Util.appendQueryString(a,"user_id=*"),Util.eraseCookie("ESTSSSOTILES")),t=n.callTokenBroker(a,i,"cookie pull")})).then(function(){var e,i=setInterval(function(){var a,r=Util.getCookie("ESTSUSERLIST",decodeURIComponent);r?(clearInterval(i),clearTimeout(e),a=(new Date).getTime()-t,n.reportTelemetry("ESTSUSERLIST.cookie.ms",a),n.updateStatus(n.STATE.INPROGRESS,"Users list cookie detected"),Util.eraseCookie("ESTSUSERLIST"),n.processUsersList(r.replace(/\+/g," "),o)):Util.getCookie("ESTSSSO")&&(clearInterval(i),clearTimeout(e),a=(new Date).getTime()-t,n.reportTelemetry("ESTSSSO.cookie.ms",a),n.reloadPage())},250);e=setTimeout(function(){clearInterval(i);var e=(new Date).getTime()-t;n.reportTelemetry("TB.response.timeout.ms",e),n.updateStatus(n.STATE.END,"Pull cookie timed out.")},n.options.overallTimeoutMs)})},callTokenBroker:function(e,t,n,o){this.updateStatus(this.STATE.START,"Initiating "+n,o);var i,a=this,r=(new Date).getTime();return window.navigator.msLaunchUri(e,function(){clearTimeout(i);var e=(new Date).getTime()-r;t.resolve(),a.reportTelemetry("msLaunchUri.success.ms",e),a.updateStatus(a.STATE.INPROGRESS,n+" initiated successfully (took "+e+" ms)",o)},function(){clearTimeout(i);var e=(new Date).getTime()-r,s="pending"===t.state();t.reject(),a.reportTelemetry("msLaunchUri.failure.ms",e),a.updateStatus(s?a.STATE.END:a.STATE.INPROGRESS,n+" was NOT initiated successfully (took "+e+" ms)",o)}),i=setTimeout(function(){clearTimeout(i),"pending"===t.state()&&("abort"==a.options.initiatePullTimeoutAction?(t.reject(),a.reportTelemetry("msLaunchUri.response","timeout"),a.updateStatus(a.STATE.END,"Initiating "+n+" timed out.",o)):(t.resolve(),a.reportTelemetry("msLaunchUri.response","timeout-continue"),a.updateStatus(a.STATE.INPROGRESS,"Initiating "+n+" timed out but starting polling anyway in case cookie was pulled.",o)))},this.options.initiatePullTimeoutMs),r},reloadPage:function(e){var t=new Date;t.setSeconds(t.getSeconds()+60),"debug"==this.bsso?(this.updateStatus(this.STATE.END_SSO,"SSO cookie detected. Refreshing page in 5 seconds (due to debug mode).",e),setTimeout(function(){Util.setCookieWithExpiration("SSOCOOKIEPULLED","1",t),-1==window.location.href.toLowerCase().indexOf("prompt=select_account")?window.location.reload(!0):window.location.replace(window.location.href.replace(/prompt=[^&]*/i,""))},5e3)):(this.updateStatus(this.STATE.END_SSO,"SSO cookie detected. Refreshing page.",e),Util.setCookieWithExpiration("SSOCOOKIEPULLED","1",t),-1==window.location.href.toLowerCase().indexOf("prompt=select_account")?setTimeout(function(){window.location.reload(!0)},0):setTimeout(function(){window.location.replace(window.location.href.replace(/prompt=[^&]*/i,""))},0))},processUsersList:function(e,t){try{if(Tiles.users||(Tiles.users=[]),Tiles.sso_users=[],$.each($.parseJSON(e).users,function(e,n){var o={name:n.display_name||"",login:n.upn,imageAAD:"work_account.png",imageMSA:"personal_account.png",isLive:!1,isWindows:!0,isSigned:!0,link:t,authUrl:"",sessionID:"",domainHint:""};Tiles.sso_users.push(o)}),Tiles.sso_users.length>0){var n=Context.email_discovery_mode;Context.email_discovery_mode=!1,Constants.IS_USE_OTHER_ACCOUNT_VISIBLE&&Tiles.users.splice(Tiles.users.length-1,1),Tiles.UpdateUsers(Tiles.users),Context.email_discovery_mode=n,this.updateStatus(this.STATE.END_USERS,"User list processed.")}else this.updateStatus(this.STATE.END,"User list is empty.")}catch(o){this.reportTelemetry("BSSO.exception","processUsersList"),this.updateStatus(this.STATE.END,"WindowsBrowserSso.processUsersList: exception: "+o)}},updateStatus:function(e,t,n){if(this.options.statusCallback&&$.isFunction(this.options.statusCallback)){this.log.push(t);try{this.options.statusCallback({state:e,message:t,tileId:n})}catch(o){this.reportTelemetry("BSSO.exception","updateStatus")}}},reportTelemetry:function(e,t){this.options.telemetryCallback&&$.isFunction(this.options.telemetryCallback)&&this.options.telemetryCallback(e,t)}},window.WindowsBrowserSso=MSLogin.WindowsBrowserSso,function(){function e(){function e(e){_++,_>Constants.OnPremPasswordValidationConfig.MaxPolls?i({statusText:"timeout"}):n.Json(Constants.OnPremPasswordValidationConfig.PollUrl,e,o,i,Constants.OnPremPasswordValidationConfig.Timeout)}function o(n){n?n.isJobPending?t.setTimeout(function(){e({FlowToken:n.flowToken,Ctx:n.ctx})},Constants.OnPremPasswordValidationConfig.PollingInterval):r(n):i()
}function i(e){$("#redirect_cta_text").hide(),$("#redirect_dots_animation").hide(),$("#redirect_dots_animation").css("visibility","hidden"),clearInterval(c),_=0,a(e),s(!0)}function a(e){var t;t=e&&"timeout"===e.statusText?Constants.OnPremPasswordValidationConfig.TimeoutErrorMessage:Constants.OnPremPasswordValidationConfig.GenericErrorMessage,$("#cta_client_error_text").text(t).show()}function r(e){$("#redirect_dots_animation").hide(),$("#redirect_dots_animation").css("visibility","hidden"),clearInterval(c),$('#endonpremvalidation input[name="flowtoken"]').val(e.flowToken),$('#endonpremvalidation input[name="ctx"]').val(e.ctx),$("#endonpremvalidation").submit()}function s(e){e?(l.show(),u&&$("#cred_cancel_button").show()):(l.hide(),u&&$("#cred_cancel_button").hide())}var d=this,_=0,c=null,l=$("#cred_userid_container,#cred_password_container,.login_cta_container,#recover_container,input#cred_password_inputtext,#cred_sign_in_button,#cred_kmsi_container"),u="visible"===$("#cred_cancel_button").css("visibility");d.startPolling=function(){var t={flowToken:Constants.OnPremPasswordValidationConfig.FlowToken,ctx:Constants.CONTEXT};s(!1),$("#redirect_cta_text").text(Constants.OnPremPasswordValidationConfig.AuthenticatingMessage),$("#redirect_cta_text").show(),$("#redirect_dots_animation").show(),$("#redirect_dots_animation").css("visibility","visible"),User.startAnimation(),c=setInterval(User.startAnimation,3500),e(t)}}var t=window,n=t.$Api;t.MSLogin.MSOnPremPasswordValidation=e}();/**
 * @preserve Copyright 2016 (C) Microsoft Corporation. All rights reserved.
 */
var proxy=function(e,t){"use strict";var n=e.FIDO=e.FIDO||{},o=n.Constants={MaxUserPromptLength:99,FinishStates:{Success:0,Cancel:1,Error:2,NotSupported:3},UnexpectedErrorCode:9999,EdgeErrorCodes:{SyntaxError:3,NotFoundError:8,NotSupportedError:9,InvalidAccessError:15,AbortError:20}};return n.getAssertion=function(e,n,i,a,r){function s(e){a({credential:{type:e.type,id:e.id},clientData:e.signature.clientData,authenticatorData:e.signature.authnrData,signature:e.signature.signature})}function d(e){r({State:e.code===_.AbortError?c.Cancel:c.Error,ExtErrorInfo:e.code})}var _=o.EdgeErrorCodes,c=o.FinishStates,l=t.msCredentials;a=a||function(){},r=r||function(){},l||r({State:c.NotSupported,ExtErrorInfo:0});try{i&&i.length>o.MaxUserPromptLength&&(i=i.substring(0,o.MaxUserPromptLength-1)),l.getAssertion(e,{accept:[{type:"FIDO_2_0",id:n}]},{userPrompt:i}).then(s,d)}catch(u){r({State:c.Error,ExtErrorInfo:o.UnexpectedErrorCode})}},e}(proxy||{},window),proxy=function(e,t){"use strict";function n(e){proxy.utilities&&proxy.utilities.logToConsole?proxy.utilities.logToConsole(e):window.Util&&window.Util.debug_console&&window.Util.debug_console(e)}function o(e){return proxy.DesktopSso.options.iwaEndpointUrlFormat.format(e)}function i(e){n("Successfully performed Integrated Windows Authentication. Submitting DesktopSSO auth token..."),t("#dssoToken").val(e),t("#credentials").submit()}function a(e){n("Integrated Windows Authentication failed with status code "+e+". Skipping DesktopSSO..."),t("#dssoToken").val("")}function r(e){n("Attempting to perform Integrated Windows Authentication..."),t.ajax({url:o(e),type:"GET",dataType:"text",cache:!1,xhrFields:{withCredentials:!0},timeout:proxy.DesktopSso.options.iwaRequestTimeoutInMs}).done(function(e,t,n){200===n.status?i(e):a(n.status)}).fail(function(e){a(e.status)})}function s(e,t){var n=t.result;n.is_dsso_enabled&&n.DomainName&&r(n.DomainName)}function d(e){return proxy.DesktopSso.options.lastUserNameTried!==e}function _(e,t){t.is_dsso_enabled&&t.DomainName&&d(t.Login)&&r(t.DomainName)}function c(){window.User?window.User.RegisterOnUserDomainHintChanged(_):t(proxy).on("BrandedUserLoaded",s)}var l=e.DesktopSso=e.DesktopSso||{};return l.Initialize=function(e){return this.options=e,this.options.iwaEndpointUrlFormat?(this.options.iwaRequestTimeoutInMs||(this.options.iwaRequestTimeoutInMs=5e3),c(),void n("Successfully initialized DesktopSSO.")):void console.error("Could not initialize DesktopSSO. Invalid IWA endpoint was passed.")},e}(proxy||{},jQuery);