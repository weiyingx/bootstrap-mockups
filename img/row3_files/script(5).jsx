typeof MSCOM=="undefined"&&(window.MSCOM={});window.MSCOM.Helper={htmlEncode:function(n){return n=="undefined"||n==null?n:$("<div/>").text(n).html()},htmlDecode:function(n){return n=="undefined"||n==null?n:$("<div/>").html(n).text()},htmlAttrEncode:function(n){return n=this.htmlEncode(n),n=n.replace(/"/g,"&quot;"),n.replace(/'/g,"&#039;")},isIE7:function(){return navigator.appVersion.indexOf("MSIE 7.")!=-1}};window.MSCOM.Helper.Content={images:{},doc:{},queue:{},curThread:0,maxThread:2,nextDelay:100,logenabled:!1,isBodyLoaded:!1,prefetchEnabled:!0,onload:function(){this.log("window.MSCOM.Helper.Content: Body Onload");this.isBodyLoaded=!0;setTimeout($.proxy(this.next,this),this.nextDelay)},log:function(n){if(this.logenabled)try{console.log(n)}catch(t){}else window.location.hash.indexOf("helplog")>0&&(this.logenabled=!0)},sortQ:function(){var n=[],i={};for(var t in this.queue)n.push(t);n.sort();for(t in n)i[n[t]]=this.queue[n[t]];this.queue=i},registerImage:function(n){if(this.prefetchEnabled){var t={path:"",priority:0,type:"img",callback:null,passvar:null,cache:!0};$.extend(t,n);this.addToQueue(t)}return this.prefetchEnabled},registerDoc:function(n){if(this.prefetchEnabled){var t={path:"",priority:0,type:"doc",callback:null,passvar:null,cache:!0};$.extend(t,n);this.addToQueue(t)}return this.prefetchEnabled},unregister:function(n){var r,i,t;for(r in this.queue)for(i=this.queue[r],t=0;t<i.length;++t)if(i[t].path===n)return this.log(["unregister",i[t]]),i.splice(t,1),!0;return!1},addToQueue:function(n){this.log(["addToQueue",n]);this.queue[n.priority]==undefined&&(this.queue[n.priority]=[],this.sortQ());this.queue[n.priority].push(n);setTimeout($.proxy(this.next,this),this.nextDelay)},next:function(){var n,t;if(!this.prefetchEnabled||this.curThread>=this.maxThread||!$.isReady&&!this.isBodyLoaded)return!1;for(t in this.queue){if(!this.isBodyLoaded&&parseInt(t)>-1)return!1;if(this.queue[t].length>0){n=this.queue[t].shift();break}}n&&(this.log(["Next:starting item",n]),this.curThread++,n.type=="img"&&this.loadImage(n),n.type=="doc"&&this.loadDocument(n))},loadImage:function(n){if(n.cache&&this.images[n.path]!=undefined&&this.images[n.path].complete)this.imageLoaded(this.images[n.path],n);else if(document.images){var t=new Image,i=this;$(t).load(function(){i.imageLoaded(t,n)});$(t).error(function(){i.imageError(t,n)});t.src=n.path;this.images[n.path]=t}},loadDocument:function(n){if(n.cache&&this.doc[n.path]!=undefined)this.docLoaded(this.doc[n.path],n);else{var t=this;$.get(n.path,function(i){t.docLoaded(i,n)})}},imageLoaded:function(n,t){this.curThread=this.curThread>0?this.curThread-1:0;t.callback&&t.callback(n,t.passvar);setTimeout($.proxy(this.next,this),this.nextDelay)},imageError:function(n,t){this.curThread=this.curThread>0?this.curThread-1:0;t.callback&&t.callback(n,t.passvar);setTimeout($.proxy(this.next,this),this.nextDelay)},docLoaded:function(n,t){this.curThread=this.curThread>0?this.curThread-1:0;try{t.callback&&t.callback(n,t.passvar)}catch(i){this.log(i)}setTimeout($.proxy(this.next,this),this.nextDelay)}};typeof $!="undefined"?$(window).load($.proxy(window.MSCOM.Helper.Content.onload,window.MSCOM.Helper.Content)):document.addEventListener?window.addEventListener("load",function(){window.MSCOM.Helper.Content.onload()},!1):window.attachEvent&&window.attachEvent("onload",function(){window.MSCOM.Helper.Content.onload()})